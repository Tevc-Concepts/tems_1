import{c as p,a as _,f as c,w as I,g,j as k,i as r,B as E,n as $,C as M,D as A,t as S,F as N,h as D,l as T,E as K,k as W,b as v,G as U,d as H,r as B,o as ee,u,A as te}from"./vue-vendor-CiCQoITm.js";import{_ as O,f as z}from"./index-CcWKIptE.js";import{p as se,i as ae,f as ne}from"./utils-CX__Uu54.js";import{A as le}from"./AppLayout-Cfv9NdWk.js";import"./useAuth-BmFAYSsb.js";function re(e,l="MMM dd, yyyy"){if(!e)return"-";const t=typeof e=="string"?se(e):e;return ae(t)?ne(t,l):"-"}const oe={key:0,class:"animate-spin -ml-1 mr-2 h-5 w-5",fill:"none",viewBox:"0 0 24 24"},ie={key:2},ce={__name:"Button",props:{label:{type:String,default:""},variant:{type:String,default:"primary",validator:e=>["primary","secondary","danger","success","outline","ghost","link"].includes(e)},size:{type:String,default:"md",validator:e=>["xs","sm","md","lg","xl"].includes(e)},type:{type:String,default:"button",validator:e=>["button","submit","reset"].includes(e)},tag:{type:String,default:"button",validator:e=>["button","a"].includes(e)},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},block:{type:Boolean,default:!1},icon:{type:[Object,String],default:null},iconRight:{type:Boolean,default:!1},rounded:{type:String,default:"lg",validator:e=>["none","sm","md","lg","full"].includes(e)}},emits:["click"],setup(e,{emit:l}){const t=e,a=l,i=p(()=>{const o=["inline-flex items-center justify-center font-medium transition-all duration-200","focus:outline-none focus:ring-2 focus:ring-offset-2","disabled:opacity-50 disabled:cursor-not-allowed"],s={xs:"px-2.5 py-1.5 text-xs",sm:"px-3 py-2 text-sm",md:"px-4 py-2.5 text-sm",lg:"px-5 py-3 text-base",xl:"px-6 py-3.5 text-base"};o.push(s[t.size]);const f={none:"rounded-none",sm:"rounded-sm",md:"rounded-md",lg:"rounded-lg",full:"rounded-full"};o.push(f[t.rounded]);const y={primary:"bg-neon-green text-charcoal hover:bg-neon-green-600 focus:ring-neon-green shadow-sm",secondary:"bg-charcoal text-white hover:bg-charcoal-light focus:ring-charcoal shadow-sm",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500 shadow-sm",success:"bg-green-600 text-white hover:bg-green-700 focus:ring-green-500 shadow-sm",outline:"border-2 border-neon-green text-neon-green hover:bg-neon-green hover:text-charcoal focus:ring-neon-green",ghost:"text-gray-700 hover:bg-gray-100 focus:ring-gray-300",link:"text-neon-green hover:text-neon-green-600 underline-offset-4 hover:underline focus:ring-neon-green"};return o.push(y[t.variant]),t.block&&o.push("w-full"),o.join(" ")}),h=p(()=>{const o=["flex-shrink-0"],s={xs:"w-3 h-3",sm:"w-4 h-4",md:"w-5 h-5",lg:"w-5 h-5",xl:"w-6 h-6"};return o.push(s[t.size]),(t.label||t.$slots.default)&&(t.iconRight?o.push("ml-2"):o.push("mr-2")),o.join(" ")});function x(o){!t.disabled&&!t.loading&&a("click",o)}return(o,s)=>(c(),_(E(e.tag),{type:e.tag==="button"?e.type:void 0,disabled:e.disabled||e.loading,class:$(i.value),onClick:x},{default:I(()=>[e.loading?(c(),g("svg",oe,[...s[0]||(s[0]=[r("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),r("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):k("",!0),e.icon&&!e.iconRight?(c(),_(E(e.icon),{key:1,class:$(h.value)},null,8,["class"])):k("",!0),o.$slots.default||e.label?(c(),g("span",ie,[M(o.$slots,"default",{},()=>[A(S(e.label),1)],!0)])):k("",!0),e.icon&&e.iconRight?(c(),_(E(e.icon),{key:3,class:$(h.value)},null,8,["class"])):k("",!0)]),_:3},8,["type","disabled","class"]))}},P=O(ce,[["__scopeId","data-v-5cd97749"]]),de={key:1,class:"flex space-x-2"},ue={key:3,class:"space-y-3 w-full"},ge={key:4,class:"w-full"},fe={__name:"Loading",props:{visible:{type:Boolean,default:!0},type:{type:String,default:"spinner",validator:e=>["spinner","dots","pulse","bar","skeleton"].includes(e)},size:{type:String,default:"md",validator:e=>["sm","md","lg","xl"].includes(e)},color:{type:String,default:"primary",validator:e=>["primary","secondary","white","gray"].includes(e)},text:{type:String,default:""},fullscreen:{type:Boolean,default:!1},overlay:{type:Boolean,default:!1},bars:{type:Number,default:3}},setup(e){const l=e,t=p(()=>{const y=["flex flex-col items-center justify-center"];return l.fullscreen&&y.push("fixed inset-0 z-50"),l.overlay&&y.push("bg-black bg-opacity-50"),y.join(" ")}),a=p(()=>[{sm:"w-6 h-6",md:"w-10 h-10",lg:"w-16 h-16",xl:"w-24 h-24"}[l.size],o.value].join(" ")),i=p(()=>({sm:"w-2 h-2",md:"w-3 h-3",lg:"w-4 h-4",xl:"w-6 h-6"})[l.size]),h=p(()=>[{sm:"w-6 h-6",md:"w-10 h-10",lg:"w-16 h-16",xl:"w-24 h-24"}[l.size],o.value,"relative"].join(" ")),x=p(()=>[{sm:"h-2",md:"h-3",lg:"h-4",xl:"h-6"}[l.size],"bg-gray-300"].join(" ")),o=p(()=>({primary:"text-neon-green",secondary:"text-charcoal",white:"text-white",gray:"text-gray-500"})[l.color]),s=p(()=>[{sm:"text-sm",md:"text-base",lg:"text-lg",xl:"text-xl"}[l.size],"mt-4 font-medium",l.overlay?"text-white":"text-gray-700"].join(" "));function f(y){const C=["100%","85%","70%","95%","80%"];return C[y%C.length]}return(y,C)=>e.visible?(c(),g("div",{key:0,class:$(t.value)},[e.type==="spinner"?(c(),g("div",{key:0,class:$(a.value)},[...C[0]||(C[0]=[r("svg",{class:"animate-spin",fill:"none",viewBox:"0 0 24 24"},[r("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),r("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)])],2)):e.type==="dots"?(c(),g("div",de,[(c(),g(N,null,D(3,m=>r("div",{key:m,class:$(["rounded-full animate-bounce",i.value,o.value]),style:T({animationDelay:`${m*.15}s`})},null,6)),64))])):e.type==="pulse"?(c(),g("div",{key:2,class:$(h.value)},[...C[1]||(C[1]=[r("div",{class:"w-full h-full rounded-full animate-ping"},null,-1)])],2)):e.type==="bar"?(c(),g("div",ue,[(c(!0),g(N,null,D(e.bars,m=>(c(),g("div",{key:m,class:$(["animate-pulse rounded",x.value]),style:T({width:f(m)})},null,6))),128))])):e.type==="skeleton"?(c(),g("div",ge,[M(y.$slots,"skeleton",{},()=>[C[2]||(C[2]=K('<div class="animate-pulse space-y-4" data-v-ceff5077><div class="flex items-center space-x-4" data-v-ceff5077><div class="rounded-full bg-gray-300 h-12 w-12" data-v-ceff5077></div><div class="flex-1 space-y-2" data-v-ceff5077><div class="h-4 bg-gray-300 rounded w-3/4" data-v-ceff5077></div><div class="h-4 bg-gray-300 rounded w-1/2" data-v-ceff5077></div></div></div><div class="space-y-2" data-v-ceff5077><div class="h-4 bg-gray-300 rounded" data-v-ceff5077></div><div class="h-4 bg-gray-300 rounded w-5/6" data-v-ceff5077></div><div class="h-4 bg-gray-300 rounded w-4/6" data-v-ceff5077></div></div></div>',1))])])):k("",!0),e.text?(c(),g("p",{key:5,class:$(s.value)},S(e.text),3)):k("",!0)],2)):k("",!0)}},q=O(fe,[["__scopeId","data-v-ceff5077"]]),ye={key:2},me={__name:"Badge",props:{label:{type:[String,Number],default:""},variant:{type:String,default:"default",validator:e=>["default","primary","secondary","success","danger","warning","info"].includes(e)},size:{type:String,default:"md",validator:e=>["sm","md","lg"].includes(e)},rounded:{type:String,default:"full",validator:e=>["sm","md","lg","full"].includes(e)},dot:{type:Boolean,default:!1},icon:{type:[Object,String],default:null},iconRight:{type:Boolean,default:!1},closable:{type:Boolean,default:!1},outline:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:l}){const t=e,a=l,i=p(()=>{const o=["inline-flex items-center justify-center font-medium","transition-all duration-200"],s={sm:"px-2 py-0.5 text-xs gap-1",md:"px-2.5 py-0.5 text-xs gap-1",lg:"px-3 py-1 text-sm gap-1.5"};o.push(s[t.size]);const f={sm:"rounded",md:"rounded-md",lg:"rounded-lg",full:"rounded-full"};if(o.push(f[t.rounded]),t.outline){const y={default:"border border-gray-300 text-gray-700 hover:bg-gray-50",primary:"border border-neon-green text-neon-green hover:bg-neon-green hover:text-charcoal",secondary:"border border-charcoal text-charcoal hover:bg-charcoal hover:text-white",success:"border border-green-500 text-green-700 hover:bg-green-50",danger:"border border-red-500 text-red-700 hover:bg-red-50",warning:"border border-yellow-500 text-yellow-700 hover:bg-yellow-50",info:"border border-blue-500 text-blue-700 hover:bg-blue-50"};o.push(y[t.variant])}else{const y={default:"bg-gray-100 text-gray-800",primary:"bg-neon-green text-charcoal",secondary:"bg-charcoal text-white",success:"bg-green-100 text-green-800",danger:"bg-red-100 text-red-800",warning:"bg-yellow-100 text-yellow-800",info:"bg-blue-100 text-blue-800"};o.push(y[t.variant])}return o.join(" ")}),h=p(()=>{const o=["w-2 h-2 rounded-full"],s={default:"bg-gray-400",primary:"bg-neon-green-700",secondary:"bg-white",success:"bg-green-500",danger:"bg-red-500",warning:"bg-yellow-500",info:"bg-blue-500"};return o.push(s[t.variant]),["success","danger","warning"].includes(t.variant)&&o.push("animate-pulse"),o.join(" ")});function x(){a("close")}return(o,s)=>(c(),g("span",{class:$(i.value)},[e.icon&&!e.iconRight?(c(),_(E(e.icon),{key:0,class:"w-3 h-3"})):k("",!0),e.dot?(c(),g("span",{key:1,class:$(h.value)},null,2)):k("",!0),o.$slots.default||e.label?(c(),g("span",ye,[M(o.$slots,"default",{},()=>[A(S(e.label),1)])])):k("",!0),e.icon&&e.iconRight?(c(),_(E(e.icon),{key:3,class:"w-3 h-3"})):k("",!0),e.closable?(c(),g("button",{key:4,type:"button",onClick:W(x,["stop"]),class:"ml-1 -mr-0.5 flex-shrink-0 hover:opacity-70 transition-opacity"},[...s[0]||(s[0]=[r("svg",{class:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20"},[r("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)])])):k("",!0)],2))}},Z=O(me,[["__scopeId","data-v-45e36c99"]]),pe={class:"flex items-center space-x-3"},he={class:"text-lg font-semibold text-gray-900"},ve={key:0,class:"text-sm text-gray-500"},xe={key:0,class:"flex items-center space-x-2"},be={key:2,class:"absolute inset-0 bg-white bg-opacity-75 flex items-center justify-center rounded-lg"},we={__name:"Card",props:{title:{type:String,default:""},subtitle:{type:String,default:""},icon:{type:[Object,String],default:null},variant:{type:String,default:"default",validator:e=>["default","bordered","elevated","flat"].includes(e)},hoverable:{type:Boolean,default:!1},clickable:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},padding:{type:Boolean,default:!0},rounded:{type:String,default:"lg",validator:e=>["none","sm","md","lg","xl"].includes(e)},headerClass:{type:String,default:""},bodyClass:{type:String,default:""},footerClass:{type:String,default:""}},emits:["click"],setup(e,{emit:l}){const t=e,a=p(()=>{const i=["relative bg-white transition-all duration-200"],h={none:"rounded-none",sm:"rounded-sm",md:"rounded-md",lg:"rounded-lg",xl:"rounded-xl"};i.push(h[t.rounded]);const x={default:"border border-gray-200",bordered:"border-2 border-gray-300",elevated:"shadow-lg",flat:""};return i.push(x[t.variant]),t.hoverable&&i.push("hover:shadow-xl hover:scale-[1.02]"),t.clickable&&i.push("cursor-pointer hover:shadow-md"),t.loading&&i.push("overflow-hidden"),i.join(" ")});return(i,h)=>(c(),g("div",{class:$(a.value)},[e.title||i.$slots.header||i.$slots.actions?(c(),g("div",{key:0,class:$(["flex items-center justify-between",e.headerClass||"px-6 py-4 border-b border-gray-200"])},[M(i.$slots,"header",{},()=>[r("div",pe,[e.icon?(c(),_(E(e.icon),{key:0,class:"w-6 h-6 text-gray-600"})):k("",!0),r("div",null,[r("h3",he,S(e.title),1),e.subtitle?(c(),g("p",ve,S(e.subtitle),1)):k("",!0)])])]),i.$slots.actions?(c(),g("div",xe,[M(i.$slots,"actions",{},void 0)])):k("",!0)],2)):k("",!0),r("div",{class:$(e.bodyClass||"px-6 py-4")},[M(i.$slots,"default",{},void 0)],2),i.$slots.footer?(c(),g("div",{key:1,class:$(e.footerClass||"px-6 py-4 border-t border-gray-200 bg-gray-50")},[M(i.$slots,"footer",{},void 0)],2)):k("",!0),e.loading?(c(),g("div",be,[v(q,{type:"spinner",size:"lg"})])):k("",!0)],2))}},R=O(we,[["__scopeId","data-v-51e49d88"]]);/**
 * @license lucide-vue-next v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ke=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(l,t,a)=>a?a.toUpperCase():t.toLowerCase()),Ce=e=>{const l=ke(e);return l.charAt(0).toUpperCase()+l.slice(1)},Se=(...e)=>e.filter((l,t,a)=>!!l&&l.trim()!==""&&a.indexOf(l)===t).join(" ").trim(),Q=e=>e==="";/**
 * @license lucide-vue-next v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var L={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};/**
 * @license lucide-vue-next v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=({name:e,iconNode:l,absoluteStrokeWidth:t,"absolute-stroke-width":a,strokeWidth:i,"stroke-width":h,size:x=L.width,color:o=L.stroke,...s},{slots:f})=>U("svg",{...L,...s,width:x,height:x,stroke:o,"stroke-width":Q(t)||Q(a)||t===!0||a===!0?Number(i||h||L["stroke-width"])*24/Number(x):i||h||L["stroke-width"],class:Se("lucide",s.class,...e?[`lucide-${G(Ce(e))}-icon`,`lucide-${G(e)}`]:["lucide-icon"])},[...l.map(y=>U(...y)),...f.default?[f.default()]:[]]);/**
 * @license lucide-vue-next v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=(e,l)=>(t,{slots:a,attrs:i})=>U($e,{...i,...t,iconNode:l,name:e},a);/**
 * @license lucide-vue-next v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=V("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-vue-next v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=V("clipboard-check",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-vue-next v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=V("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-vue-next v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=V("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-vue-next v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=V("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Be=H("incident",()=>{const e=B([]),l=B([]),t=B(!1),a=B(null),i=p(()=>e.value.length),h=p(()=>e.value.filter(n=>n.severity==="critical").length),x=p(()=>e.value.filter(n=>n.status==="open"||n.status==="investigating"));async function o(n={}){t.value=!0,a.value=null;try{const d=await z.call({method:"tems.api.pwa.safety.get_incidents",args:{filters:n}});return e.value=d.message||[],e.value}catch(d){throw a.value=d.message,d}finally{t.value=!1}}async function s(){t.value=!0,a.value=null;try{const n=await z.call({method:"tems.api.pwa.safety.get_critical_incidents",args:{}});return l.value=n.message||[],l.value}catch(n){throw a.value=n.message,n}finally{t.value=!1}}async function f(n){t.value=!0,a.value=null;try{const b=(await z.call({method:"tems.api.pwa.safety.report_incident",args:{incident_data:n}})).message;return e.value.unshift(b),b}catch(d){throw a.value=d.message,d}finally{t.value=!1}}async function y(n,d,b=""){try{const w=await z.call({method:"tems.api.pwa.safety.update_incident_status",args:{incident_id:n,status:d,notes:b}}),j=e.value.findIndex(F=>F.name===n);return j!==-1&&(e.value[j].status=d),w.message}catch(w){throw a.value=w.message,w}}async function C(n,d){try{const b=await z.call({method:"tems.api.pwa.safety.assign_investigator",args:{incident_id:n,investigator_id:d}}),w=e.value.findIndex(j=>j.name===n);return w!==-1&&(e.value[w].investigator=d),b.message}catch(b){throw a.value=b.message,b}}function m(){a.value=null}return{incidents:e,criticalIncidents:l,loading:t,error:a,totalIncidents:i,criticalCount:h,openIncidents:x,fetchIncidents:o,fetchCriticalIncidents:s,reportIncident:f,updateIncidentStatus:y,assignInvestigator:C,clearError:m}}),je=H("audit",()=>{const e=B([]),l=B([]),t=B(!1),a=B(null),i=p(()=>e.value.length),h=p(()=>e.value.filter(m=>m.status==="completed").length),x=p(()=>e.value.filter(m=>m.status==="scheduled"||m.status==="in_progress"));async function o(m={}){t.value=!0,a.value=null;try{const n=await z.call({method:"tems.api.pwa.safety.get_audits",args:{filters:m}});return e.value=n.message||[],e.value}catch(n){throw a.value=n.message,n}finally{t.value=!1}}async function s(){t.value=!0,a.value=null;try{const m=await z.call({method:"tems.api.pwa.safety.get_upcoming_audits",args:{}});return l.value=m.message||[],l.value}catch(m){throw a.value=m.message,m}finally{t.value=!1}}async function f(m){t.value=!0,a.value=null;try{const d=(await z.call({method:"tems.api.pwa.safety.schedule_audit",args:{audit_data:m}})).message;return e.value.unshift(d),d}catch(n){throw a.value=n.message,n}finally{t.value=!1}}async function y(m,n){try{const d=await z.call({method:"tems.api.pwa.safety.submit_audit_findings",args:{audit_id:m,findings:n}}),b=e.value.findIndex(w=>w.name===m);return b!==-1&&(e.value[b].status="completed",e.value[b].findings=n),d.message}catch(d){throw a.value=d.message,d}}function C(){a.value=null}return{audits:e,upcomingAudits:l,loading:t,error:a,totalAudits:i,completedAudits:h,pendingAudits:x,fetchAudits:o,fetchUpcomingAudits:s,scheduleAudit:f,submitAuditFindings:y,clearError:C}}),Ae=H("compliance",()=>{const e=B([]),l=B([]),t=B(!1),a=B(null),i=p(()=>e.value.length),h=p(()=>e.value.filter(n=>n.status==="compliant").length),x=p(()=>e.value.filter(n=>n.status==="non_compliant").length),o=p(()=>i.value===0?0:(h.value/i.value*100).toFixed(1));async function s(n={}){t.value=!0,a.value=null;try{const d=await z.call({method:"tems.api.pwa.safety.get_compliance_items",args:{filters:n}});return e.value=d.message||[],e.value}catch(d){throw a.value=d.message,d}finally{t.value=!1}}async function f(n=30){t.value=!0,a.value=null;try{const d=await z.call({method:"tems.api.pwa.safety.get_expiring_compliance",args:{days:n}});return l.value=d.message||[],l.value}catch(d){throw a.value=d.message,d}finally{t.value=!1}}async function y(n,d,b=""){try{const w=await z.call({method:"tems.api.pwa.safety.update_compliance_status",args:{item_id:n,status:d,notes:b}}),j=e.value.findIndex(F=>F.name===n);return j!==-1&&(e.value[j].status=d),w.message}catch(w){throw a.value=w.message,w}}async function C(n,d){try{const b=await z.call({method:"tems.api.pwa.safety.renew_compliance",args:{item_id:n,expiry_date:d}}),w=e.value.findIndex(j=>j.name===n);return w!==-1&&(e.value[w].expiry_date=d,e.value[w].status="compliant"),b.message}catch(b){throw a.value=b.message,b}}function m(){a.value=null}return{complianceItems:e,expiringItems:l,loading:t,error:a,totalItems:i,compliantCount:h,nonCompliantCount:x,complianceRate:o,fetchComplianceItems:s,fetchExpiringItems:f,updateComplianceStatus:y,renewCompliance:C,clearError:m}}),Me={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},_e={class:"flex items-center justify-between"},Re={class:"text-3xl font-bold text-primary-600"},Ee={class:"flex items-center justify-between"},Le={class:"text-3xl font-bold text-error"},Ve={class:"flex items-center justify-between"},Ne={class:"text-3xl font-bold text-success"},De={class:"flex items-center justify-between"},Oe={class:"text-3xl font-bold text-warning"},Fe={class:"mb-8"},Pe={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Ue={class:"mb-8"},qe={class:"text-lg font-semibold text-gray-900 mb-4 flex items-center"},He={key:0,class:"text-center py-8"},Te={key:1,class:"text-center py-8 text-gray-500"},Ze={key:2,class:"space-y-4"},Ge={class:"font-medium text-gray-900"},Qe={class:"text-sm text-gray-600"},Je={key:0,class:"text-center py-8"},Xe={key:1,class:"text-center py-8 text-gray-500"},Ye={key:2,class:"space-y-4"},Ke={class:"font-medium text-gray-900"},We={class:"text-sm text-gray-600"},lt={__name:"Dashboard",setup(e){const l=te(),t=Be(),a=je(),i=Ae(),h=p(()=>t.criticalIncidents.slice(0,5)),x=p(()=>i.expiringItems.slice(0,5));return ee(async()=>{await Promise.all([t.fetchCriticalIncidents(),t.fetchIncidents({limit:10}),a.fetchUpcomingAudits(),i.fetchExpiringItems(30),i.fetchComplianceItems()])}),(o,s)=>(c(),_(u(le),null,{header:I(()=>[...s[3]||(s[3]=[r("h1",{class:"text-2xl font-bold text-gray-900"},"Safety Dashboard",-1)])]),default:I(()=>[r("div",Me,[v(u(R),null,{default:I(()=>[r("div",_e,[r("div",null,[s[4]||(s[4]=r("p",{class:"text-sm text-gray-600"},"Open Incidents",-1)),r("p",Re,S(u(t).openIncidents.length),1)]),v(u(Y),{class:"w-12 h-12 text-primary-400"})])]),_:1}),v(u(R),null,{default:I(()=>[r("div",Ee,[r("div",null,[s[5]||(s[5]=r("p",{class:"text-sm text-gray-600"},"Critical Incidents",-1)),r("p",Le,S(u(t).criticalCount),1)]),v(u(Ie),{class:"w-12 h-12 text-error"})])]),_:1}),v(u(R),null,{default:I(()=>[r("div",Ve,[r("div",null,[s[6]||(s[6]=r("p",{class:"text-sm text-gray-600"},"Compliance Rate",-1)),r("p",Ne,S(u(i).complianceRate)+"%",1)]),v(u(X),{class:"w-12 h-12 text-success"})])]),_:1}),v(u(R),null,{default:I(()=>[r("div",De,[r("div",null,[s[7]||(s[7]=r("p",{class:"text-sm text-gray-600"},"Pending Audits",-1)),r("p",Oe,S(u(a).pendingAudits.length),1)]),v(u(J),{class:"w-12 h-12 text-warning"})])]),_:1})]),r("div",Fe,[s[11]||(s[11]=r("h2",{class:"text-xl font-semibold text-gray-900 mb-4"},"Quick Actions",-1)),r("div",Pe,[v(u(P),{variant:"primary",onClick:s[0]||(s[0]=f=>u(l).push("/incidents")),class:"py-6"},{default:I(()=>[v(u(ze),{class:"w-5 h-5 mr-2"}),s[8]||(s[8]=A(" Report Incident ",-1))]),_:1}),v(u(P),{variant:"secondary",onClick:s[1]||(s[1]=f=>u(l).push("/audits")),class:"py-6"},{default:I(()=>[v(u(J),{class:"w-5 h-5 mr-2"}),s[9]||(s[9]=A(" Schedule Audit ",-1))]),_:1}),v(u(P),{variant:"secondary",onClick:s[2]||(s[2]=f=>u(l).push("/compliance")),class:"py-6"},{default:I(()=>[v(u(X),{class:"w-5 h-5 mr-2"}),s[10]||(s[10]=A(" Check Compliance ",-1))]),_:1})])]),r("div",Ue,[v(u(R),null,{default:I(()=>[r("h3",qe,[v(u(Y),{class:"w-5 h-5 text-primary-600 mr-2"}),s[12]||(s[12]=A(" Critical Incidents ",-1))]),u(t).loading?(c(),g("div",He,[v(u(q))])):h.value.length===0?(c(),g("div",Te," No critical incidents ")):(c(),g("div",Ze,[(c(!0),g(N,null,D(h.value,f=>(c(),g("div",{key:f.name,class:"flex items-center justify-between p-4 border border-red-200 bg-red-50 rounded-lg hover:bg-red-100"},[r("div",null,[r("h4",Ge,S(f.title),1),r("p",Qe,S(f.location)+" â€¢ "+S(f.reported_by),1)]),v(u(Z),{variant:"error"},{default:I(()=>[A(S(f.status),1)]),_:2},1024)]))),128))]))]),_:1})]),r("div",null,[s[14]||(s[14]=r("h2",{class:"text-xl font-semibold text-gray-900 mb-4"},"Expiring Compliance",-1)),v(u(R),null,{default:I(()=>[u(i).loading?(c(),g("div",Je,[v(u(q))])):x.value.length===0?(c(),g("div",Xe," No items expiring soon ")):(c(),g("div",Ye,[(c(!0),g(N,null,D(x.value,f=>(c(),g("div",{key:f.name,class:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50"},[r("div",null,[r("h4",Ke,S(f.title),1),r("p",We,"Expires: "+S(u(re)(f.expiry_date)),1)]),v(u(Z),{variant:"warning"},{default:I(()=>[...s[13]||(s[13]=[A(" Expiring Soon ",-1)])]),_:1})]))),128))]))]),_:1})])]),_:1}))}};export{lt as default};
//# sourceMappingURL=Dashboard-CFKVnlST.js.map
