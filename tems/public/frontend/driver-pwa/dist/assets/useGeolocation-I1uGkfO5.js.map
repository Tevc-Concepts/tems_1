{"version":3,"file":"useGeolocation-I1uGkfO5.js","sources":["../../../../../../frontend/driver-pwa/src/composables/useGeolocation.js"],"sourcesContent":["import { ref, onMounted, onUnmounted } from 'vue'\n\nexport function useGeolocation(options = {}) {\n    const coords = ref(null)\n    const error = ref(null)\n    const loading = ref(false)\n    const watchId = ref(null)\n\n    const defaultOptions = {\n        enableHighAccuracy: true,\n        timeout: 10000,\n        maximumAge: 0,\n        ...options\n    }\n\n    async function getCurrentPosition() {\n        loading.value = true\n        error.value = null\n\n        return new Promise((resolve, reject) => {\n            if (!navigator.geolocation) {\n                const err = new Error('Geolocation is not supported by your browser')\n                error.value = err\n                loading.value = false\n                reject(err)\n                return\n            }\n\n            navigator.geolocation.getCurrentPosition(\n                (position) => {\n                    coords.value = {\n                        latitude: position.coords.latitude,\n                        longitude: position.coords.longitude,\n                        accuracy: position.coords.accuracy,\n                        altitude: position.coords.altitude,\n                        heading: position.coords.heading,\n                        speed: position.coords.speed,\n                        timestamp: position.timestamp\n                    }\n                    loading.value = false\n                    resolve(coords.value)\n                },\n                (err) => {\n                    error.value = err\n                    loading.value = false\n                    reject(err)\n                },\n                defaultOptions\n            )\n        })\n    }\n\n    function startWatching() {\n        if (!navigator.geolocation) {\n            error.value = new Error('Geolocation is not supported by your browser')\n            return\n        }\n\n        if (watchId.value) {\n            stopWatching()\n        }\n\n        watchId.value = navigator.geolocation.watchPosition(\n            (position) => {\n                coords.value = {\n                    latitude: position.coords.latitude,\n                    longitude: position.coords.longitude,\n                    accuracy: position.coords.accuracy,\n                    altitude: position.coords.altitude,\n                    heading: position.coords.heading,\n                    speed: position.coords.speed,\n                    timestamp: position.timestamp\n                }\n                error.value = null\n            },\n            (err) => {\n                error.value = err\n            },\n            defaultOptions\n        )\n    }\n\n    function stopWatching() {\n        if (watchId.value !== null) {\n            navigator.geolocation.clearWatch(watchId.value)\n            watchId.value = null\n        }\n    }\n\n    onUnmounted(() => {\n        stopWatching()\n    })\n\n    return {\n        coords,\n        error,\n        loading,\n        getCurrentPosition,\n        startWatching,\n        stopWatching\n    }\n}\n\n// Calculate distance between two coordinates (Haversine formula)\nexport function calculateDistance(lat1, lon1, lat2, lon2) {\n    const R = 6371 // Earth's radius in km\n    const dLat = toRad(lat2 - lat1)\n    const dLon = toRad(lon2 - lon1)\n\n    const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n        Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) *\n        Math.sin(dLon / 2) * Math.sin(dLon / 2)\n\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a))\n    const distance = R * c\n\n    return distance // in kilometers\n}\n\nfunction toRad(degrees) {\n    return degrees * (Math.PI / 180)\n}\n\n// Format coordinates for display\nexport function formatCoordinates(lat, lon) {\n    const latDir = lat >= 0 ? 'N' : 'S'\n    const lonDir = lon >= 0 ? 'E' : 'W'\n\n    return `${Math.abs(lat).toFixed(6)}°${latDir}, ${Math.abs(lon).toFixed(6)}°${lonDir}`\n}\n"],"names":["useGeolocation","options","coords","ref","error","loading","watchId","defaultOptions","getCurrentPosition","resolve","reject","err","position","startWatching","stopWatching","onUnmounted","formatCoordinates","lat","lon","latDir","lonDir"],"mappings":"+CAEO,SAASA,EAAeC,EAAU,GAAI,CACzC,MAAMC,EAASC,EAAI,IAAI,EACjBC,EAAQD,EAAI,IAAI,EAChBE,EAAUF,EAAI,EAAK,EACnBG,EAAUH,EAAI,IAAI,EAElBI,EAAiB,CACnB,mBAAoB,GACpB,QAAS,IACT,WAAY,EACZ,GAAGN,CACX,EAEI,eAAeO,GAAqB,CAChC,OAAAH,EAAQ,MAAQ,GAChBD,EAAM,MAAQ,KAEP,IAAI,QAAQ,CAACK,EAASC,IAAW,CACpC,GAAI,CAAC,UAAU,YAAa,CACxB,MAAMC,EAAM,IAAI,MAAM,8CAA8C,EACpEP,EAAM,MAAQO,EACdN,EAAQ,MAAQ,GAChBK,EAAOC,CAAG,EACV,MACJ,CAEA,UAAU,YAAY,mBACjBC,GAAa,CACVV,EAAO,MAAQ,CACX,SAAUU,EAAS,OAAO,SAC1B,UAAWA,EAAS,OAAO,UAC3B,SAAUA,EAAS,OAAO,SAC1B,SAAUA,EAAS,OAAO,SAC1B,QAASA,EAAS,OAAO,QACzB,MAAOA,EAAS,OAAO,MACvB,UAAWA,EAAS,SAC5C,EACoBP,EAAQ,MAAQ,GAChBI,EAAQP,EAAO,KAAK,CACxB,EACCS,GAAQ,CACLP,EAAM,MAAQO,EACdN,EAAQ,MAAQ,GAChBK,EAAOC,CAAG,CACd,EACAJ,CAChB,CACQ,CAAC,CACL,CAEA,SAASM,GAAgB,CACrB,GAAI,CAAC,UAAU,YAAa,CACxBT,EAAM,MAAQ,IAAI,MAAM,8CAA8C,EACtE,MACJ,CAEIE,EAAQ,OACRQ,EAAY,EAGhBR,EAAQ,MAAQ,UAAU,YAAY,cACjCM,GAAa,CACVV,EAAO,MAAQ,CACX,SAAUU,EAAS,OAAO,SAC1B,UAAWA,EAAS,OAAO,UAC3B,SAAUA,EAAS,OAAO,SAC1B,SAAUA,EAAS,OAAO,SAC1B,QAASA,EAAS,OAAO,QACzB,MAAOA,EAAS,OAAO,MACvB,UAAWA,EAAS,SACxC,EACgBR,EAAM,MAAQ,IAClB,EACCO,GAAQ,CACLP,EAAM,MAAQO,CAClB,EACAJ,CACZ,CACI,CAEA,SAASO,GAAe,CAChBR,EAAQ,QAAU,OAClB,UAAU,YAAY,WAAWA,EAAQ,KAAK,EAC9CA,EAAQ,MAAQ,KAExB,CAEA,OAAAS,EAAY,IAAM,CACdD,EAAY,CAChB,CAAC,EAEM,CACH,OAAAZ,EACA,MAAAE,EACA,QAAAC,EACA,mBAAAG,EACA,cAAAK,EACA,aAAAC,CACR,CACA,CAuBO,SAASE,EAAkBC,EAAKC,EAAK,CACxC,MAAMC,EAASF,GAAO,EAAI,IAAM,IAC1BG,EAASF,GAAO,EAAI,IAAM,IAEhC,MAAO,GAAG,KAAK,IAAID,CAAG,EAAE,QAAQ,CAAC,CAAC,IAAIE,CAAM,KAAK,KAAK,IAAID,CAAG,EAAE,QAAQ,CAAC,CAAC,IAAIE,CAAM,EACvF"}