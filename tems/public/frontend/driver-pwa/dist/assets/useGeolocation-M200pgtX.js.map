{"version":3,"file":"useGeolocation-M200pgtX.js","sources":["../../../../../../frontend/shared/src/composables/useGeolocation.js"],"sourcesContent":["import { ref, onUnmounted } from 'vue'\n\n/**\n * Geolocation composable with tracking capabilities\n * Provides GPS coordinates and location tracking\n * \n * @param {object} options - Geolocation options\n * @returns {object} Geolocation state and methods\n * \n * @example\n * ```javascript\n * import { useGeolocation } from '@shared/composables/useGeolocation'\n * \n * const { coords, getCurrentPosition, startWatching, stopWatching } = useGeolocation()\n * \n * // Get current position once\n * await getCurrentPosition()\n * console.log(coords.value.latitude, coords.value.longitude)\n * \n * // Start continuous tracking\n * startWatching()\n * \n * // Stop tracking\n * stopWatching()\n * ```\n */\nexport function useGeolocation(options = {}) {\n    const coords = ref(null)\n    const error = ref(null)\n    const loading = ref(false)\n    const watchId = ref(null)\n    const isWatching = ref(false)\n\n    const defaultOptions = {\n        enableHighAccuracy: true,\n        timeout: 10000,\n        maximumAge: 0,\n        ...options\n    }\n\n    /**\n     * Get current position once\n     */\n    async function getCurrentPosition() {\n        loading.value = true\n        error.value = null\n\n        return new Promise((resolve, reject) => {\n            if (!navigator.geolocation) {\n                const err = new Error('Geolocation is not supported by your browser')\n                error.value = err\n                loading.value = false\n                reject(err)\n                return\n            }\n\n            navigator.geolocation.getCurrentPosition(\n                (position) => {\n                    coords.value = {\n                        latitude: position.coords.latitude,\n                        longitude: position.coords.longitude,\n                        accuracy: position.coords.accuracy,\n                        altitude: position.coords.altitude,\n                        altitudeAccuracy: position.coords.altitudeAccuracy,\n                        heading: position.coords.heading,\n                        speed: position.coords.speed,\n                        timestamp: position.timestamp\n                    }\n                    loading.value = false\n                    resolve(coords.value)\n                },\n                (err) => {\n                    error.value = err\n                    loading.value = false\n                    reject(err)\n                },\n                defaultOptions\n            )\n        })\n    }\n\n    /**\n     * Start continuous position tracking\n     */\n    function startWatching() {\n        if (!navigator.geolocation) {\n            error.value = new Error('Geolocation is not supported by your browser')\n            return\n        }\n\n        if (watchId.value) {\n            stopWatching()\n        }\n\n        watchId.value = navigator.geolocation.watchPosition(\n            (position) => {\n                coords.value = {\n                    latitude: position.coords.latitude,\n                    longitude: position.coords.longitude,\n                    accuracy: position.coords.accuracy,\n                    altitude: position.coords.altitude,\n                    altitudeAccuracy: position.coords.altitudeAccuracy,\n                    heading: position.coords.heading,\n                    speed: position.coords.speed,\n                    timestamp: position.timestamp\n                }\n                error.value = null\n                isWatching.value = true\n            },\n            (err) => {\n                error.value = err\n                isWatching.value = false\n            },\n            defaultOptions\n        )\n    }\n\n    /**\n     * Stop position tracking\n     */\n    function stopWatching() {\n        if (watchId.value !== null) {\n            navigator.geolocation.clearWatch(watchId.value)\n            watchId.value = null\n            isWatching.value = false\n        }\n    }\n\n    /**\n     * Calculate distance between two coordinates (Haversine formula)\n     * @param {number} lat1 - Latitude 1\n     * @param {number} lon1 - Longitude 1\n     * @param {number} lat2 - Latitude 2\n     * @param {number} lon2 - Longitude 2\n     * @returns {number} Distance in meters\n     */\n    function calculateDistance(lat1, lon1, lat2, lon2) {\n        const R = 6371e3 // Earth's radius in meters\n        const φ1 = lat1 * Math.PI / 180\n        const φ2 = lat2 * Math.PI / 180\n        const Δφ = (lat2 - lat1) * Math.PI / 180\n        const Δλ = (lon2 - lon1) * Math.PI / 180\n\n        const a = Math.sin(Δφ / 2) * Math.sin(Δφ / 2) +\n            Math.cos(φ1) * Math.cos(φ2) *\n            Math.sin(Δλ / 2) * Math.sin(Δλ / 2)\n        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a))\n\n        return R * c\n    }\n\n    /**\n     * Calculate bearing between two coordinates\n     * @param {number} lat1 - Latitude 1\n     * @param {number} lon1 - Longitude 1\n     * @param {number} lat2 - Latitude 2\n     * @param {number} lon2 - Longitude 2\n     * @returns {number} Bearing in degrees (0-360)\n     */\n    function calculateBearing(lat1, lon1, lat2, lon2) {\n        const φ1 = lat1 * Math.PI / 180\n        const φ2 = lat2 * Math.PI / 180\n        const Δλ = (lon2 - lon1) * Math.PI / 180\n\n        const y = Math.sin(Δλ) * Math.cos(φ2)\n        const x = Math.cos(φ1) * Math.sin(φ2) -\n            Math.sin(φ1) * Math.cos(φ2) * Math.cos(Δλ)\n        const θ = Math.atan2(y, x)\n        const bearing = (θ * 180 / Math.PI + 360) % 360\n\n        return bearing\n    }\n\n    /**\n     * Format coordinates as string\n     * @param {number} lat - Latitude\n     * @param {number} lng - Longitude\n     * @returns {string} Formatted coordinates\n     */\n    function formatCoords(lat, lng) {\n        if (lat === null || lat === undefined || lng === null || lng === undefined) {\n            return 'N/A'\n        }\n        return `${lat.toFixed(6)}, ${lng.toFixed(6)}`\n    }\n\n    /**\n     * Check if coordinates are valid\n     * @param {number} lat - Latitude\n     * @param {number} lng - Longitude\n     * @returns {boolean}\n     */\n    function isValidCoords(lat, lng) {\n        return (\n            typeof lat === 'number' &&\n            typeof lng === 'number' &&\n            lat >= -90 &&\n            lat <= 90 &&\n            lng >= -180 &&\n            lng <= 180\n        )\n    }\n\n    // Cleanup on unmount\n    onUnmounted(() => {\n        stopWatching()\n    })\n\n    return {\n        // State\n        coords,\n        error,\n        loading,\n        isWatching,\n\n        // Actions\n        getCurrentPosition,\n        startWatching,\n        stopWatching,\n\n        // Utilities\n        calculateDistance,\n        calculateBearing,\n        formatCoords,\n        isValidCoords\n    }\n}\n"],"names":["useGeolocation","options","coords","ref","error","loading","watchId","isWatching","defaultOptions","getCurrentPosition","resolve","reject","err","position","startWatching","stopWatching","calculateDistance","lat1","lon1","lat2","lon2","φ1","φ2","Δφ","Δλ","a","calculateBearing","y","x","formatCoords","lat","lng","isValidCoords","onUnmounted"],"mappings":"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"}