import{r as b,a as f,k as c,b as o,g as k,d as y,s as m,H as C,I,z as g,f as v,e as x,l as S,p as T,j as V}from"./index-PcK2SAYs.js";import{u as M}from"./incident-D1Lz0-dy.js";import{u as $}from"./useGeolocation-CaOISwgq.js";import{C as B,_ as F}from"./CameraModal-BmKdMrkY.js";import{M as P}from"./map-pin-jftitRPm.js";import"./Modal-BTtRlE28.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./x-BbFY30U9.js";import"./createLucideIcon-BA_zicjl.js";import"./refresh-cw-hDmae7zB.js";const N={class:"bg-white rounded-xl shadow-card p-4"},R={class:"mb-4"},U={class:"mb-4"},j={class:"mb-4"},q={class:"flex space-x-2"},D={class:"mb-4"},L={key:0,class:"mt-2"},A=["src"],E={__name:"IncidentReportForm",emits:["submit"],setup(p,{emit:l}){const i=l,{getCurrentPosition:r}=$(),s=b(!1),e=b({incident_type:"",description:"",location:"",photo:null,coordinates:null}),a=async()=>{try{const n=await r();e.value.coordinates={latitude:n.coords.latitude,longitude:n.coords.longitude},e.value.location=`${n.coords.latitude.toFixed(6)}, ${n.coords.longitude.toFixed(6)}`}catch(n){console.error("Failed to get location:",n)}},h=()=>{s.value=!0},w=n=>{e.value.photo=n.dataUrl,s.value=!1},_=()=>{i("submit",e.value)};return(n,t)=>(c(),f("form",{onSubmit:T(_,["prevent"]),class:"space-y-4"},[o("div",N,[o("div",R,[t[5]||(t[5]=o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Incident Type",-1)),m(o("select",{"onUpdate:modelValue":t[0]||(t[0]=d=>e.value.incident_type=d),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:""},[...t[4]||(t[4]=[I('<option value="">Select Type</option><option value="Accident">Accident</option><option value="Breakdown">Breakdown</option><option value="Medical">Medical Emergency</option><option value="Security">Security Issue</option><option value="Other">Other</option>',6)])],512),[[C,e.value.incident_type]])]),o("div",U,[t[6]||(t[6]=o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Description",-1)),m(o("textarea",{"onUpdate:modelValue":t[1]||(t[1]=d=>e.value.description=d),rows:"4",class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Describe what happened...",required:""},null,512),[[g,e.value.description]])]),o("div",j,[t[7]||(t[7]=o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Location",-1)),o("div",q,[m(o("input",{"onUpdate:modelValue":t[2]||(t[2]=d=>e.value.location=d),type:"text",class:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Location details",required:""},null,512),[[g,e.value.location]]),o("button",{type:"button",onClick:a,class:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700"},[v(x(P),{class:"w-5 h-5"})])])]),o("div",D,[t[9]||(t[9]=o("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Photos",-1)),o("button",{type:"button",onClick:h,class:"w-full px-4 py-2 border-2 border-dashed border-gray-300 rounded-lg hover:border-primary-500 flex items-center justify-center"},[v(x(B),{class:"w-5 h-5 mr-2"}),t[8]||(t[8]=S(" Take Photo ",-1))]),e.value.photo?(c(),f("div",L,[o("img",{src:e.value.photo,alt:"Incident photo",class:"w-full h-40 object-cover rounded-lg"},null,8,A)])):y("",!0)]),t[10]||(t[10]=o("button",{type:"submit",class:"w-full py-3 bg-danger-600 text-white rounded-lg font-medium hover:bg-danger-700 transition"}," Submit Report ",-1))]),s.value?(c(),k(F,{key:0,onClose:t[3]||(t[3]=d=>s.value=!1),onCapture:w})):y("",!0)],32))}},u=b([]);let O=0;function z(){const p=(i,r="info",s=5e3)=>{const e=++O,a={id:e,message:i,type:r,duration:s};return u.value.push(a),s>0&&setTimeout(()=>{l(e)},s),e},l=i=>{const r=u.value.findIndex(s=>s.id===i);r>-1&&u.value.splice(r,1)};return{toasts:u,showToast:p,removeToast:l}}const G={class:"min-h-screen bg-background pb-20"},H={class:"p-4"},st={__name:"IncidentReport",setup(p){const l=V(),i=M(),{showToast:r}=z(),s=async e=>{try{await i.reportIncident(e),r("Incident reported successfully","success"),l.push("/driver")}catch{r("Failed to report incident","error")}};return(e,a)=>(c(),f("div",G,[o("div",H,[a[0]||(a[0]=o("h1",{class:"text-2xl font-bold text-gray-800 mb-4"},"Report Incident",-1)),v(E,{onSubmit:s})])]))}};export{st as default};
//# sourceMappingURL=IncidentReport-Ce6dx739.js.map
