{"version":3,"file":"Communication-Ch7WAAvX.js","sources":["../../../../../../frontend/driver-pwa/node_modules/lucide-vue-next/dist/esm/icons/message-circle.js","../../../../../../frontend/driver-pwa/node_modules/lucide-vue-next/dist/esm/icons/paperclip.js","../../../../../../frontend/driver-pwa/node_modules/lucide-vue-next/dist/esm/icons/send.js","../../../../../../frontend/driver-pwa/src/views/Communication.vue"],"sourcesContent":["/**\n * @license lucide-vue-next v0.545.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst MessageCircle = createLucideIcon(\"message-circle\", [\n  [\n    \"path\",\n    {\n      d: \"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719\",\n      key: \"1sd12s\"\n    }\n  ]\n]);\n\nexport { MessageCircle as default };\n//# sourceMappingURL=message-circle.js.map\n","/**\n * @license lucide-vue-next v0.545.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Paperclip = createLucideIcon(\"paperclip\", [\n  [\n    \"path\",\n    {\n      d: \"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551\",\n      key: \"1miecu\"\n    }\n  ]\n]);\n\nexport { Paperclip as default };\n//# sourceMappingURL=paperclip.js.map\n","/**\n * @license lucide-vue-next v0.545.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Send = createLucideIcon(\"send\", [\n  [\n    \"path\",\n    {\n      d: \"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z\",\n      key: \"1ffxy3\"\n    }\n  ],\n  [\"path\", { d: \"m21.854 2.147-10.94 10.939\", key: \"12cjpa\" }]\n]);\n\nexport { Send as default };\n//# sourceMappingURL=send.js.map\n","<template>\n  <div class=\"h-[calc(100vh-12rem)] flex flex-col\">\n    <!-- Header -->\n    <div class=\"card p-4 mb-4\">\n      <h2 class=\"text-xl font-bold text-gray-900 mb-2\">Messages</h2>\n      <p class=\"text-sm text-gray-600\">Communication with Operations Control</p>\n    </div>\n\n    <!-- Messages List -->\n    <div class=\"flex-1 card overflow-hidden flex flex-col\">\n      <div v-if=\"commStore.loading\" class=\"flex-1 flex items-center justify-center\">\n        <LoadingSpinner message=\"Loading messages...\" />\n      </div>\n\n      <div v-else-if=\"messages.length === 0\" class=\"flex-1 flex items-center justify-center\">\n        <EmptyState\n          :icon=\"MessageCircle\"\n          title=\"No messages\"\n          message=\"You don't have any messages yet. Start a conversation with operations control.\"\n        />\n      </div>\n\n      <div v-else ref=\"messageContainer\" class=\"flex-1 overflow-y-auto p-4 space-y-4\">\n        <div\n          v-for=\"message in messages\"\n          :key=\"message.name || message.timestamp\"\n          class=\"flex\"\n          :class=\"message.sender === 'me' ? 'justify-end' : 'justify-start'\"\n        >\n          <div\n            class=\"max-w-[75%] rounded-2xl px-4 py-2\"\n            :class=\"message.sender === 'me' \n              ? 'bg-primary-600 text-white' \n              : 'bg-gray-100 text-gray-900'\"\n          >\n            <p class=\"text-sm whitespace-pre-wrap\">{{ message.message }}</p>\n            <p\n              class=\"text-xs mt-1\"\n              :class=\"message.sender === 'me' ? 'text-primary-100' : 'text-gray-500'\"\n            >\n              {{ formatMessageTime(message.timestamp) }}\n            </p>\n          </div>\n        </div>\n      </div>\n\n      <!-- Message Input -->\n      <div class=\"p-4 border-t bg-white\">\n        <form @submit.prevent=\"sendMessage\" class=\"flex items-end space-x-2\">\n          <div class=\"flex-1\">\n            <textarea\n              v-model=\"newMessage\"\n              placeholder=\"Type your message...\"\n              rows=\"2\"\n              class=\"w-full px-4 py-2 border border-gray-300 rounded-xl resize-none focus:ring-2 focus:ring-primary-500 focus:border-transparent\"\n              @keydown.enter.exact.prevent=\"sendMessage\"\n            ></textarea>\n          </div>\n          \n          <button\n            type=\"button\"\n            @click=\"attachFile\"\n            class=\"btn-secondary p-3\"\n            :disabled=\"commStore.loading\"\n          >\n            <Paperclip class=\"w-5 h-5\" />\n          </button>\n          \n          <button\n            type=\"submit\"\n            class=\"btn-primary p-3\"\n            :disabled=\"!newMessage.trim() || commStore.loading\"\n          >\n            <Send class=\"w-5 h-5\" />\n          </button>\n        </form>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted, nextTick } from 'vue'\nimport { format, parseISO } from 'date-fns'\nimport { MessageCircle, Send, Paperclip } from 'lucide-vue-next'\nimport { useCommunicationStore } from '@/stores/communication'\nimport LoadingSpinner from '@/components/common/LoadingSpinner.vue'\nimport EmptyState from '@/components/common/EmptyState.vue'\n\nconst commStore = useCommunicationStore()\nconst newMessage = ref('')\nconst messageContainer = ref(null)\n\nconst messages = computed(() => commStore.messages)\n\nasync function sendMessage() {\n  if (!newMessage.value.trim()) return\n\n  try {\n    await commStore.sendMessage('Operations Control', 'operations', newMessage.value)\n    newMessage.value = ''\n    \n    // Scroll to bottom\n    await nextTick()\n    if (messageContainer.value) {\n      messageContainer.value.scrollTop = messageContainer.value.scrollHeight\n    }\n  } catch (error) {\n    console.error('Failed to send message:', error)\n  }\n}\n\nfunction attachFile() {\n  // TODO: Implement file attachment\n  console.log('Attach file')\n}\n\nfunction formatMessageTime(timestamp) {\n  if (!timestamp) return ''\n  try {\n    const date = typeof timestamp === 'string' ? parseISO(timestamp) : timestamp\n    return format(date, 'HH:mm')\n  } catch (e) {\n    return ''\n  }\n}\n\nonMounted(async () => {\n  await commStore.fetchMessages()\n  \n  // Scroll to bottom after loading\n  await nextTick()\n  if (messageContainer.value) {\n    messageContainer.value.scrollTop = messageContainer.value.scrollHeight\n  }\n})\n</script>\n"],"names":["MessageCircle","createLucideIcon","Paperclip","Send","commStore","useCommunicationStore","newMessage","ref","messageContainer","messages","computed","sendMessage","nextTick","error","attachFile","formatMessageTime","timestamp","date","parseISO","format","onMounted","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_unref","_hoisted_3","_createVNode","LoadingSpinner","_hoisted_4","EmptyState","_Fragment","_renderList","message","_normalizeClass","_hoisted_5","_toDisplayString","_hoisted_6","_hoisted_7","$event"],"mappings":"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","x_google_ignoreList":[0,1,2]}