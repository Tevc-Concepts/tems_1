import{u as j,x as T,r as g,c as W,q as D,a as i,k as a,b as e,f as o,e as t,t as y,d as b,n as w,w as _,h as O,T as L,F as E,i as P,g as k,m as I,y as G,s as Y,z as J,l as K,A as Q,o as X}from"./index-PcK2SAYs.js";import{_ as z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{T as Z}from"./truck-CIvaZl73.js";import{R as ee}from"./refresh-cw-hDmae7zB.js";import{U,C as te}from"./user-duRkX_VX.js";import{c as $}from"./createLucideIcon-BA_zicjl.js";import{L as se}from"./log-out-C3CLS_jr.js";import{M as B}from"./map-pin-jftitRPm.js";import{T as A}from"./triangle-alert-FxvP7yeT.js";import{u as ae,f as oe}from"./useGeolocation-CaOISwgq.js";import{u as re}from"./incident-D1Lz0-dy.js";import{M as ne}from"./Modal-BTtRlE28.js";import{T as le}from"./Toast-mYUahUM_.js";import{C as M}from"./circle-alert-DgqhRVXg.js";import"./x-BbFY30U9.js";import"./info-DqSwZgxb.js";import"./circle-x-DQl-CdHB.js";/**
 * @license lucide-vue-next v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=$("ambulance",[["path",{d:"M10 10H6",key:"1bsnug"}],["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.28a1 1 0 0 0-.684-.948l-1.923-.641a1 1 0 0 1-.578-.502l-1.539-3.076A1 1 0 0 0 16.382 8H14",key:"lrkjwd"}],["path",{d:"M8 8v4",key:"1fwk8c"}],["path",{d:"M9 18h6",key:"x1upvd"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-vue-next v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=$("car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-vue-next v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=$("circle-user",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-vue-next v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=$("layout-dashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-vue-next v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=$("wifi-off",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-vue-next v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=$("wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]]),fe={class:"sticky top-0 z-50 bg-gradient-to-r from-primary-600 to-primary-500 text-white shadow-lg"},he={class:"max-w-7xl mx-auto px-4"},ye={class:"flex items-center justify-between h-16"},xe={class:"flex items-center space-x-3"},ve={class:"w-10 h-10 bg-white rounded-lg flex items-center justify-center shadow-md"},ge={class:"text-xs text-primary-100"},be={class:"flex items-center space-x-3"},_e=["disabled"],we={class:"w-8 h-8 bg-white rounded-full flex items-center justify-center"},ke={key:0,class:"absolute right-4 top-20 w-64 bg-white rounded-xl shadow-2xl overflow-hidden z-50"},$e={class:"p-4 bg-gradient-to-br from-primary-50 to-white border-b"},Se={class:"font-semibold text-gray-900"},Ce={class:"text-sm text-gray-600"},Me={class:"p-2"},Ae={__name:"AppHeader",setup(S){const f=D(),h=j(),c=T(),n=g(!1),x=W(()=>f.meta.title||"Dashboard");async function d(){try{await c.syncOfflineData()}catch(l){console.error("Sync failed:",l)}}async function m(){await h.logout()}return(l,r)=>{const v=O("router-link");return a(),i("header",fe,[e("div",he,[e("div",ye,[e("div",xe,[e("div",ve,[o(t(Z),{class:"w-6 h-6 text-primary-600"})]),e("div",null,[r[2]||(r[2]=e("h1",{class:"text-lg font-bold"},"TEMS Driver",-1)),e("p",ge,y(x.value),1)])]),e("div",be,[t(c).hasPendingChanges?(a(),i("button",{key:0,onClick:d,class:"p-2 rounded-lg bg-white/20 hover:bg-white/30 transition-colors",disabled:t(c).syncInProgress},[o(t(ee),{class:w(["w-5 h-5",t(c).syncInProgress&&"animate-spin"])},null,8,["class"])],8,_e)):b("",!0),e("button",{onClick:r[0]||(r[0]=C=>n.value=!n.value),class:"flex items-center space-x-2 p-2 rounded-lg hover:bg-white/20 transition-colors"},[e("div",we,[o(t(U),{class:"w-5 h-5 text-primary-600"})])])])])]),o(L,{name:"slide-down"},{default:_(()=>[n.value?(a(),i("div",ke,[e("div",$e,[e("p",Se,y(t(h).driverName),1),e("p",Ce,y(t(h).user?.email),1)]),e("div",Me,[o(v,{to:"/driver/profile",class:"flex items-center space-x-3 px-4 py-3 rounded-lg hover:bg-gray-50 transition-colors text-gray-700",onClick:r[1]||(r[1]=C=>n.value=!1)},{default:_(()=>[o(t(de),{class:"w-5 h-5"}),r[3]||(r[3]=e("span",null,"My Profile",-1))]),_:1}),e("button",{onClick:m,class:"w-full flex items-center space-x-3 px-4 py-3 rounded-lg hover:bg-red-50 transition-colors text-red-600"},[o(t(se),{class:"w-5 h-5"}),r[4]||(r[4]=e("span",null,"Logout",-1))])])])):b("",!0)]),_:1})])}}},Te=z(Ae,[["__scopeId","data-v-de6fa219"]]),Oe={class:"fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 safe-bottom z-40"},Le={class:"max-w-7xl mx-auto px-2"},Ie={class:"flex justify-around items-center h-16"},ze={class:"text-xs font-medium"},Ve={key:0,class:"absolute bottom-0 w-12 h-1 bg-primary-600 rounded-t-full"},je={__name:"AppBottomNav",setup(S){const f=D(),h=[{name:"dashboard",label:"Dashboard",path:"/driver",icon:ue},{name:"trips",label:"Trips",path:"/driver/trips",icon:B},{name:"inspection",label:"Inspect",path:"/driver/inspection",icon:te},{name:"incident",label:"Incident",path:"/driver/incident",icon:A},{name:"profile",label:"Profile",path:"/driver/profile",icon:U}];function c(n){return n==="/driver"?f.path===n:f.path.startsWith(n)}return(n,x)=>{const d=O("router-link");return a(),i("nav",Oe,[e("div",Le,[e("div",Ie,[(a(),i(E,null,P(h,m=>o(d,{key:m.name,to:m.path,class:w(["flex flex-col items-center justify-center flex-1 py-2 px-1 rounded-lg transition-all duration-200",c(m.path)?"text-primary-600":"text-gray-500 hover:text-gray-700"])},{default:_(()=>[(a(),k(I(m.icon),{class:w(["w-6 h-6 mb-1 transition-transform",c(m.path)&&"scale-110"])},null,8,["class"])),e("span",ze,y(m.label),1),c(m.path)?(a(),i("div",Ve)):b("",!0)]),_:2},1032,["to","class"])),64))])])])}}},De={key:0,class:"fixed bottom-20 left-4 right-4 bg-amber-500 text-white px-4 py-3 rounded-lg shadow-lg z-50 flex items-center justify-between"},Ee={class:"flex items-center space-x-2"},Pe={key:0,class:"bg-white text-amber-600 px-2 py-1 rounded text-xs font-bold"},Ue={__name:"OfflineIndicator",setup(S){const f=T();return(h,c)=>(a(),k(L,{name:"slide-up"},{default:_(()=>[t(f).isOnline?b("",!0):(a(),i("div",De,[e("div",Ee,[o(t(me),{class:"w-5 h-5"}),c[0]||(c[0]=e("div",null,[e("p",{class:"font-medium text-sm"},"You're offline"),e("p",{class:"text-xs text-amber-100"},"Changes will sync when online")],-1))]),t(f).hasPendingChanges?(a(),i("div",Pe,y(t(f).pendingSync)+" pending ",1)):b("",!0)]))]),_:1}))}},Be=z(Ue,[["__scopeId","data-v-29eedb03"]]),He=["disabled"],Ne={class:"space-y-4"},Fe={class:"p-4 bg-red-50 border border-red-200 rounded-lg"},qe={class:"flex items-start space-x-3"},Re={key:0,class:"p-4 bg-gray-50 rounded-lg"},We={class:"flex items-start space-x-3"},Ge={class:"flex-1"},Ye={class:"text-xs text-gray-600 mt-1"},Je={class:"text-xs text-gray-500 mt-1"},Ke={key:1,class:"p-4 bg-gray-50 rounded-lg text-center"},Qe={key:2,class:"p-4 bg-amber-50 border border-amber-200 rounded-lg"},Xe={class:"flex items-start space-x-2"},Ze={class:"text-xs text-amber-700 mt-1"},et={class:"grid grid-cols-2 gap-2"},tt=["onClick"],st={class:"text-sm font-medium text-gray-900"},at={class:"flex space-x-3 pt-4"},ot=["disabled"],rt=["disabled"],nt={key:1,class:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"},lt={__name:"SOSButton",setup(S){const{coords:f,error:h,getCurrentPosition:c}=ae(),n=g(!1),x=g(!1),d=g(!1),m=g(!1),l=g(null),r=g(""),v=g("general"),C=re(),H=[{value:"medical",label:"Medical",icon:ie},{value:"accident",label:"Accident",icon:ce},{value:"breakdown",label:"Breakdown",icon:pe},{value:"general",label:"Other",icon:M}];async function N(){n.value=!0,r.value="",v.value="general",await V()}async function V(){m.value=!0;try{const u=await c();l.value=u}catch(u){console.error("Failed to get location:",u)}finally{m.value=!1}}async function F(){await V()}function q(u){v.value=u.value,r.value||(r.value=`${u.label} emergency`)}async function R(){d.value=!0;try{const u={lat:l.value?.latitude,lng:l.value?.longitude,accuracy:l.value?.accuracy},s=`${v.value.toUpperCase()}: ${r.value||"Emergency situation"}`;await C.sendSOSAlert(u,s),n.value=!1,x.value=!0,r.value="",v.value="general",l.value=null,"vibrate"in navigator&&navigator.vibrate([200,100,200,100,200])}catch(u){console.error("Failed to send SOS:",u),alert("Failed to send SOS alert. Please try calling emergency services directly.")}finally{d.value=!1}}return G(()=>f.value,u=>{u&&!l.value&&(l.value=u)}),(u,s)=>(a(),k(Q,{to:"body"},[n.value?b("",!0):(a(),i("button",{key:0,onClick:N,class:w(["fixed bottom-24 right-4 z-40 w-16 h-16 bg-red-600 hover:bg-red-700 rounded-full shadow-lg flex items-center justify-center animate-pulse active:scale-95 transition-transform",{"opacity-50":d.value}]),disabled:d.value},[o(t(M),{class:"w-8 h-8 text-white"})],10,He)),o(ne,{modelValue:n.value,"onUpdate:modelValue":s[2]||(s[2]=p=>n.value=p),title:"Emergency SOS",size:"md","close-on-backdrop":!1},{default:_(()=>[e("div",Ne,[e("div",Fe,[e("div",qe,[o(t(A),{class:"w-6 h-6 text-red-600 flex-shrink-0 mt-0.5"}),s[4]||(s[4]=e("div",null,[e("p",{class:"font-semibold text-red-900"},"Emergency Alert"),e("p",{class:"text-sm text-red-700 mt-1"}," This will send an immediate alert to the operations control room with your current location. ")],-1))])]),l.value?(a(),i("div",Re,[e("div",We,[o(t(B),{class:"w-5 h-5 text-gray-600 flex-shrink-0 mt-0.5"}),e("div",Ge,[s[5]||(s[5]=e("p",{class:"text-sm font-medium text-gray-900"},"Current Location",-1)),e("p",Ye,y(t(oe)(l.value.latitude,l.value.longitude)),1),e("p",Je," Accuracy: Â±"+y(Math.round(l.value.accuracy))+"m ",1)])])])):m.value?(a(),i("div",Ke,[...s[6]||(s[6]=[e("div",{class:"inline-block w-6 h-6 border-2 border-gray-300 border-t-primary-600 rounded-full animate-spin mb-2"},null,-1),e("p",{class:"text-sm text-gray-600"},"Getting your location...",-1)])])):t(h)?(a(),i("div",Qe,[e("div",Xe,[o(t(A),{class:"w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5"}),e("div",null,[s[7]||(s[7]=e("p",{class:"text-sm font-medium text-amber-900"},"Location Error",-1)),e("p",Ze,y(t(h)),1),e("button",{onClick:F,class:"mt-2 text-xs text-amber-700 underline"}," Try Again ")])])])):b("",!0),e("div",null,[s[8]||(s[8]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Additional Information (Optional) ",-1)),Y(e("textarea",{"onUpdate:modelValue":s[0]||(s[0]=p=>r.value=p),rows:"3",class:"w-full px-4 py-2 border border-gray-300 rounded-lg resize-none focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"Describe the emergency situation..."},null,512),[[J,r.value]])]),e("div",null,[s[9]||(s[9]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Emergency Type ",-1)),e("div",et,[(a(),i(E,null,P(H,p=>e("button",{key:p.value,onClick:mt=>q(p),class:w(["p-3 border rounded-lg text-left hover:bg-gray-50 transition-colors",v.value===p.value?"border-red-600 bg-red-50":"border-gray-300"])},[(a(),k(I(p.icon),{class:w(["w-5 h-5 mb-1",v.value===p.value?"text-red-600":"text-gray-600"])},null,8,["class"])),e("p",st,y(p.label),1)],10,tt)),64))])]),e("div",at,[e("button",{onClick:s[1]||(s[1]=p=>n.value=!1),class:"flex-1 btn-secondary py-3",disabled:d.value}," Cancel ",8,ot),e("button",{onClick:R,class:"flex-1 bg-red-600 hover:bg-red-700 text-white font-semibold py-3 px-4 rounded-lg transition-colors flex items-center justify-center",disabled:d.value||!l.value&&!t(h)},[d.value?(a(),i("div",nt)):(a(),k(t(M),{key:0,class:"w-5 h-5 mr-2"})),K(" "+y(d.value?"Sending...":"Send SOS Alert"),1)],8,rt)])])]),_:1},8,["modelValue"]),o(le,{modelValue:x.value,"onUpdate:modelValue":s[3]||(s[3]=p=>x.value=p),type:"success",title:"SOS Alert Sent",message:"Emergency services have been notified. Help is on the way."},null,8,["modelValue"])]))}},it={class:"min-h-screen flex flex-col bg-gray-50"},ct={class:"flex-1 pb-20 safe-bottom"},dt={class:"max-w-7xl mx-auto px-4 py-6"},ut={__name:"AppLayout",setup(S){const f=j(),h=T();return X(async()=>{await f.fetchUserInfo(),h.initializeOnlineListener()}),(c,n)=>{const x=O("router-view");return a(),i("div",it,[o(Te),e("main",ct,[e("div",dt,[o(x,null,{default:_(({Component:d})=>[o(L,{name:"fade",mode:"out-in"},{default:_(()=>[(a(),k(I(d)))]),_:2},1024)]),_:1})])]),o(je),o(lt),o(Be)])}}},Ot=z(ut,[["__scopeId","data-v-cbcd851d"]]);export{Ot as default};
//# sourceMappingURL=AppLayout-CBjlc8mU.js.map
