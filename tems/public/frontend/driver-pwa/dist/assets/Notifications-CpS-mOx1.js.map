{"version":3,"file":"Notifications-CpS-mOx1.js","sources":["../../../../../../frontend/driver-pwa/node_modules/lucide-vue-next/dist/esm/icons/bell.js","../../../../../../frontend/driver-pwa/src/views/Notifications.vue"],"sourcesContent":["/**\n * @license lucide-vue-next v0.545.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Bell = createLucideIcon(\"bell\", [\n  [\"path\", { d: \"M10.268 21a2 2 0 0 0 3.464 0\", key: \"vwvbt9\" }],\n  [\n    \"path\",\n    {\n      d: \"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326\",\n      key: \"11g9vi\"\n    }\n  ]\n]);\n\nexport { Bell as default };\n//# sourceMappingURL=bell.js.map\n","<template>\n  <div class=\"space-y-6\">\n    <!-- Header -->\n    <div class=\"card p-4\">\n      <h2 class=\"text-xl font-bold text-gray-900 mb-2\">Notifications</h2>\n      <p class=\"text-sm text-gray-600\">Stay updated with important alerts</p>\n    </div>\n\n    <!-- Unread Count Badge -->\n    <div v-if=\"unreadCount > 0\" class=\"card p-4 bg-primary-50 border-l-4 border-primary-600\">\n      <div class=\"flex items-center space-x-3\">\n        <Bell class=\"w-6 h-6 text-primary-600\" />\n        <div>\n          <p class=\"font-semibold text-gray-900\">{{ unreadCount }} Unread Notification{{ unreadCount > 1 ? 's' : '' }}</p>\n          <p class=\"text-sm text-gray-600\">Tap on a notification to mark as read</p>\n        </div>\n      </div>\n    </div>\n\n    <!-- Loading State -->\n    <div v-if=\"commStore.loading\" class=\"card p-8\">\n      <LoadingSpinner message=\"Loading notifications...\" />\n    </div>\n\n    <!-- Empty State -->\n    <div v-else-if=\"notifications.length === 0\" class=\"card p-8\">\n      <EmptyState\n        :icon=\"Bell\"\n        title=\"No notifications\"\n        message=\"You're all caught up! No new notifications at the moment.\"\n      />\n    </div>\n\n    <!-- Notifications List -->\n    <div v-else class=\"card divide-y\">\n      <div\n        v-for=\"notification in notifications\"\n        :key=\"notification.name\"\n        class=\"p-4 hover:bg-gray-50 cursor-pointer transition-colors\"\n        :class=\"{ 'bg-blue-50': !notification.read }\"\n        @click=\"markAsRead(notification)\"\n      >\n        <div class=\"flex items-start space-x-3\">\n          <div\n            class=\"flex-shrink-0 w-10 h-10 rounded-lg flex items-center justify-center\"\n            :class=\"getNotificationIconBg(notification.document_type)\"\n          >\n            <component :is=\"getNotificationIcon(notification.document_type)\" class=\"w-5 h-5\" />\n          </div>\n\n          <div class=\"flex-1 min-w-0\">\n            <div class=\"flex items-start justify-between mb-1\">\n              <p class=\"font-semibold text-gray-900 truncate\">{{ notification.subject }}</p>\n              <span v-if=\"!notification.read\" class=\"w-2 h-2 bg-blue-600 rounded-full ml-2 mt-2\"></span>\n            </div>\n            \n            <div\n              v-if=\"notification.email_content\"\n              class=\"text-sm text-gray-600 line-clamp-2\"\n              v-html=\"notification.email_content\"\n            ></div>\n\n            <div class=\"flex items-center space-x-4 mt-2 text-xs text-gray-500\">\n              <span>{{ formatTimestamp(notification.creation) }}</span>\n              <span v-if=\"notification.document_type && notification.document_name\" class=\"flex items-center space-x-1\">\n                <FileText class=\"w-3 h-3\" />\n                <span>{{ notification.document_type }}</span>\n              </span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Refresh Button -->\n    <button\n      @click=\"refreshNotifications\"\n      class=\"w-full btn-secondary py-3\"\n      :disabled=\"commStore.loading\"\n    >\n      <RefreshCw class=\"w-5 h-5 mr-2\" :class=\"{ 'animate-spin': commStore.loading }\" />\n      Refresh\n    </button>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted } from 'vue'\nimport { formatDistanceToNow, parseISO } from 'date-fns'\nimport { \n  Bell, RefreshCw, FileText, AlertTriangle, CheckCircle, \n  Info, Truck, Package, Users \n} from 'lucide-vue-next'\nimport { useCommunicationStore } from '@/stores/communication'\nimport LoadingSpinner from '@/components/common/LoadingSpinner.vue'\nimport EmptyState from '@/components/common/EmptyState.vue'\n\nconst commStore = useCommunicationStore()\n\nconst notifications = computed(() => commStore.notifications)\nconst unreadCount = computed(() => commStore.unreadCount)\n\nfunction getNotificationIcon(docType) {\n  const iconMap = {\n    'Journey Plan': Truck,\n    'Operation Plan': Truck,\n    'Safety Incident': AlertTriangle,\n    'Cargo Consignment': Package,\n    'Passenger Booking': Users,\n    'Vehicle': Truck,\n  }\n  return iconMap[docType] || Info\n}\n\nfunction getNotificationIconBg(docType) {\n  const bgMap = {\n    'Journey Plan': 'bg-blue-100 text-blue-600',\n    'Operation Plan': 'bg-blue-100 text-blue-600',\n    'Safety Incident': 'bg-red-100 text-red-600',\n    'Cargo Consignment': 'bg-amber-100 text-amber-600',\n    'Passenger Booking': 'bg-green-100 text-green-600',\n    'Vehicle': 'bg-purple-100 text-purple-600',\n  }\n  return bgMap[docType] || 'bg-gray-100 text-gray-600'\n}\n\nfunction formatTimestamp(timestamp) {\n  if (!timestamp) return ''\n  try {\n    const date = typeof timestamp === 'string' ? parseISO(timestamp) : timestamp\n    return formatDistanceToNow(date, { addSuffix: true })\n  } catch (e) {\n    return ''\n  }\n}\n\nasync function markAsRead(notification) {\n  if (!notification.read) {\n    try {\n      await commStore.markNotificationRead(notification.name)\n    } catch (error) {\n      console.error('Failed to mark notification as read:', error)\n    }\n  }\n}\n\nasync function refreshNotifications() {\n  try {\n    await commStore.fetchNotifications()\n  } catch (error) {\n    console.error('Failed to refresh notifications:', error)\n  }\n}\n\nonMounted(async () => {\n  await commStore.fetchNotifications()\n})\n</script>\n\n<style scoped>\n.line-clamp-2 {\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n}\n</style>\n"],"names":["Bell","createLucideIcon","commStore","useCommunicationStore","notifications","computed","unreadCount","getNotificationIcon","docType","Truck","AlertTriangle","Package","Users","Info","getNotificationIconBg","formatTimestamp","timestamp","date","parseISO","formatDistanceToNow","markAsRead","notification","error","refreshNotifications","onMounted","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_createVNode","_unref","_hoisted_4","_toDisplayString","_cache","_hoisted_5","LoadingSpinner","_hoisted_6","EmptyState","_hoisted_7","_Fragment","_renderList","_normalizeClass","$event","_hoisted_9","_createBlock","_resolveDynamicComponent","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_15","_hoisted_16","FileText","RefreshCw"],"mappings":"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","x_google_ignoreList":[0]}