import{c as p,a as E,f as c,w as B,g as u,j as C,i as n,D as R,n as $,E as A,C as M,t as S,F as N,h as D,y as K,l as T,k as W,b as x,G as U,d as H,r as I,o as ee,u as g,B as te}from"./vue-vendor-Dxtg618h.js";import{_ as O,f as z}from"./index-CzaUriAi.js";import{p as se,i as ae,f as ne}from"./utils-CX__Uu54.js";function le(e,r="MMM dd, yyyy"){if(!e)return"-";const t=typeof e=="string"?se(e):e;return ae(t)?ne(t,r):"-"}const re={key:0,class:"animate-spin -ml-1 mr-2 h-5 w-5",fill:"none",viewBox:"0 0 24 24"},oe={key:2},ie={__name:"Button",props:{label:{type:String,default:""},variant:{type:String,default:"primary",validator:e=>["primary","secondary","danger","success","outline","ghost","link"].includes(e)},size:{type:String,default:"md",validator:e=>["xs","sm","md","lg","xl"].includes(e)},type:{type:String,default:"button",validator:e=>["button","submit","reset"].includes(e)},tag:{type:String,default:"button",validator:e=>["button","a"].includes(e)},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},block:{type:Boolean,default:!1},icon:{type:[Object,String],default:null},iconRight:{type:Boolean,default:!1},rounded:{type:String,default:"lg",validator:e=>["none","sm","md","lg","full"].includes(e)}},emits:["click"],setup(e,{emit:r}){const t=e,a=r,i=p(()=>{const o=["inline-flex items-center justify-center font-medium transition-all duration-200","focus:outline-none focus:ring-2 focus:ring-offset-2","disabled:opacity-50 disabled:cursor-not-allowed"],m={xs:"px-2.5 py-1.5 text-xs",sm:"px-3 py-2 text-sm",md:"px-4 py-2.5 text-sm",lg:"px-5 py-3 text-base",xl:"px-6 py-3.5 text-base"};o.push(m[t.size]);const y={none:"rounded-none",sm:"rounded-sm",md:"rounded-md",lg:"rounded-lg",full:"rounded-full"};o.push(y[t.rounded]);const s={primary:"bg-neon-green text-charcoal hover:bg-neon-green-600 focus:ring-neon-green shadow-sm",secondary:"bg-charcoal text-white hover:bg-charcoal-light focus:ring-charcoal shadow-sm",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500 shadow-sm",success:"bg-green-600 text-white hover:bg-green-700 focus:ring-green-500 shadow-sm",outline:"border-2 border-neon-green text-neon-green hover:bg-neon-green hover:text-charcoal focus:ring-neon-green",ghost:"text-gray-700 hover:bg-gray-100 focus:ring-gray-300",link:"text-neon-green hover:text-neon-green-600 underline-offset-4 hover:underline focus:ring-neon-green"};return o.push(s[t.variant]),t.block&&o.push("w-full"),o.join(" ")}),v=p(()=>{const o=["flex-shrink-0"],m={xs:"w-3 h-3",sm:"w-4 h-4",md:"w-5 h-5",lg:"w-5 h-5",xl:"w-6 h-6"};return o.push(m[t.size]),(t.label||t.$slots.default)&&(t.iconRight?o.push("ml-2"):o.push("mr-2")),o.join(" ")});function b(o){!t.disabled&&!t.loading&&a("click",o)}return(o,m)=>(c(),E(R(e.tag),{type:e.tag==="button"?e.type:void 0,disabled:e.disabled||e.loading,class:$(i.value),onClick:b},{default:B(()=>[e.loading?(c(),u("svg",re,[...m[0]||(m[0]=[n("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),n("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):C("",!0),e.icon&&!e.iconRight?(c(),E(R(e.icon),{key:1,class:$(v.value)},null,8,["class"])):C("",!0),o.$slots.default||e.label?(c(),u("span",oe,[A(o.$slots,"default",{},()=>[M(S(e.label),1)],!0)])):C("",!0),e.icon&&e.iconRight?(c(),E(R(e.icon),{key:3,class:$(v.value)},null,8,["class"])):C("",!0)]),_:3},8,["type","disabled","class"]))}},P=O(ie,[["__scopeId","data-v-5cd97749"]]),ce={key:1,class:"flex space-x-2"},de={key:3,class:"space-y-3 w-full"},ue={key:4,class:"w-full"},ge={__name:"Loading",props:{visible:{type:Boolean,default:!0},type:{type:String,default:"spinner",validator:e=>["spinner","dots","pulse","bar","skeleton"].includes(e)},size:{type:String,default:"md",validator:e=>["sm","md","lg","xl"].includes(e)},color:{type:String,default:"primary",validator:e=>["primary","secondary","white","gray"].includes(e)},text:{type:String,default:""},fullscreen:{type:Boolean,default:!1},overlay:{type:Boolean,default:!1},bars:{type:Number,default:3}},setup(e){const r=e,t=p(()=>{const s=["flex flex-col items-center justify-center"];return r.fullscreen&&s.push("fixed inset-0 z-50"),r.overlay&&s.push("bg-black bg-opacity-50"),s.join(" ")}),a=p(()=>[{sm:"w-6 h-6",md:"w-10 h-10",lg:"w-16 h-16",xl:"w-24 h-24"}[r.size],o.value].join(" ")),i=p(()=>({sm:"w-2 h-2",md:"w-3 h-3",lg:"w-4 h-4",xl:"w-6 h-6"})[r.size]),v=p(()=>[{sm:"w-6 h-6",md:"w-10 h-10",lg:"w-16 h-16",xl:"w-24 h-24"}[r.size],o.value,"relative"].join(" ")),b=p(()=>[{sm:"h-2",md:"h-3",lg:"h-4",xl:"h-6"}[r.size],"bg-gray-300"].join(" ")),o=p(()=>({primary:"text-neon-green",secondary:"text-charcoal",white:"text-white",gray:"text-gray-500"})[r.color]),m=p(()=>[{sm:"text-sm",md:"text-base",lg:"text-lg",xl:"text-xl"}[r.size],"mt-4 font-medium",r.overlay?"text-white":"text-gray-700"].join(" "));function y(s){const f=["100%","85%","70%","95%","80%"];return f[s%f.length]}return(s,f)=>e.visible?(c(),u("div",{key:0,class:$(t.value)},[e.type==="spinner"?(c(),u("div",{key:0,class:$(a.value)},[...f[0]||(f[0]=[n("svg",{class:"animate-spin",fill:"none",viewBox:"0 0 24 24"},[n("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),n("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1)])],2)):e.type==="dots"?(c(),u("div",ce,[(c(),u(N,null,D(3,h=>n("div",{key:h,class:$(["rounded-full animate-bounce",i.value,o.value]),style:T({animationDelay:`${h*.15}s`})},null,6)),64))])):e.type==="pulse"?(c(),u("div",{key:2,class:$(v.value)},[...f[1]||(f[1]=[n("div",{class:"w-full h-full rounded-full animate-ping"},null,-1)])],2)):e.type==="bar"?(c(),u("div",de,[(c(!0),u(N,null,D(e.bars,h=>(c(),u("div",{key:h,class:$(["animate-pulse rounded",b.value]),style:T({width:y(h)})},null,6))),128))])):e.type==="skeleton"?(c(),u("div",ue,[A(s.$slots,"skeleton",{},()=>[f[2]||(f[2]=K('<div class="animate-pulse space-y-4" data-v-ceff5077><div class="flex items-center space-x-4" data-v-ceff5077><div class="rounded-full bg-gray-300 h-12 w-12" data-v-ceff5077></div><div class="flex-1 space-y-2" data-v-ceff5077><div class="h-4 bg-gray-300 rounded w-3/4" data-v-ceff5077></div><div class="h-4 bg-gray-300 rounded w-1/2" data-v-ceff5077></div></div></div><div class="space-y-2" data-v-ceff5077><div class="h-4 bg-gray-300 rounded" data-v-ceff5077></div><div class="h-4 bg-gray-300 rounded w-5/6" data-v-ceff5077></div><div class="h-4 bg-gray-300 rounded w-4/6" data-v-ceff5077></div></div></div>',1))])])):C("",!0),e.text?(c(),u("p",{key:5,class:$(m.value)},S(e.text),3)):C("",!0)],2)):C("",!0)}},q=O(ge,[["__scopeId","data-v-ceff5077"]]),fe={key:2},ye={__name:"Badge",props:{label:{type:[String,Number],default:""},variant:{type:String,default:"default",validator:e=>["default","primary","secondary","success","danger","warning","info"].includes(e)},size:{type:String,default:"md",validator:e=>["sm","md","lg"].includes(e)},rounded:{type:String,default:"full",validator:e=>["sm","md","lg","full"].includes(e)},dot:{type:Boolean,default:!1},icon:{type:[Object,String],default:null},iconRight:{type:Boolean,default:!1},closable:{type:Boolean,default:!1},outline:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:r}){const t=e,a=r,i=p(()=>{const o=["inline-flex items-center justify-center font-medium","transition-all duration-200"],m={sm:"px-2 py-0.5 text-xs gap-1",md:"px-2.5 py-0.5 text-xs gap-1",lg:"px-3 py-1 text-sm gap-1.5"};o.push(m[t.size]);const y={sm:"rounded",md:"rounded-md",lg:"rounded-lg",full:"rounded-full"};if(o.push(y[t.rounded]),t.outline){const s={default:"border border-gray-300 text-gray-700 hover:bg-gray-50",primary:"border border-neon-green text-neon-green hover:bg-neon-green hover:text-charcoal",secondary:"border border-charcoal text-charcoal hover:bg-charcoal hover:text-white",success:"border border-green-500 text-green-700 hover:bg-green-50",danger:"border border-red-500 text-red-700 hover:bg-red-50",warning:"border border-yellow-500 text-yellow-700 hover:bg-yellow-50",info:"border border-blue-500 text-blue-700 hover:bg-blue-50"};o.push(s[t.variant])}else{const s={default:"bg-gray-100 text-gray-800",primary:"bg-neon-green text-charcoal",secondary:"bg-charcoal text-white",success:"bg-green-100 text-green-800",danger:"bg-red-100 text-red-800",warning:"bg-yellow-100 text-yellow-800",info:"bg-blue-100 text-blue-800"};o.push(s[t.variant])}return o.join(" ")}),v=p(()=>{const o=["w-2 h-2 rounded-full"],m={default:"bg-gray-400",primary:"bg-neon-green-700",secondary:"bg-white",success:"bg-green-500",danger:"bg-red-500",warning:"bg-yellow-500",info:"bg-blue-500"};return o.push(m[t.variant]),["success","danger","warning"].includes(t.variant)&&o.push("animate-pulse"),o.join(" ")});function b(){a("close")}return(o,m)=>(c(),u("span",{class:$(i.value)},[e.icon&&!e.iconRight?(c(),E(R(e.icon),{key:0,class:"w-3 h-3"})):C("",!0),e.dot?(c(),u("span",{key:1,class:$(v.value)},null,2)):C("",!0),o.$slots.default||e.label?(c(),u("span",fe,[A(o.$slots,"default",{},()=>[M(S(e.label),1)])])):C("",!0),e.icon&&e.iconRight?(c(),E(R(e.icon),{key:3,class:"w-3 h-3"})):C("",!0),e.closable?(c(),u("button",{key:4,type:"button",onClick:W(b,["stop"]),class:"ml-1 -mr-0.5 flex-shrink-0 hover:opacity-70 transition-opacity"},[...m[0]||(m[0]=[n("svg",{class:"w-3 h-3",fill:"currentColor",viewBox:"0 0 20 20"},[n("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)])])):C("",!0)],2))}},Z=O(ye,[["__scopeId","data-v-45e36c99"]]),me={class:"flex items-center space-x-3"},he={class:"text-lg font-semibold text-gray-900"},pe={key:0,class:"text-sm text-gray-500"},ve={key:0,class:"flex items-center space-x-2"},xe={key:2,class:"absolute inset-0 bg-white bg-opacity-75 flex items-center justify-center rounded-lg"},be={__name:"Card",props:{title:{type:String,default:""},subtitle:{type:String,default:""},icon:{type:[Object,String],default:null},variant:{type:String,default:"default",validator:e=>["default","bordered","elevated","flat"].includes(e)},hoverable:{type:Boolean,default:!1},clickable:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},padding:{type:Boolean,default:!0},rounded:{type:String,default:"lg",validator:e=>["none","sm","md","lg","xl"].includes(e)},headerClass:{type:String,default:""},bodyClass:{type:String,default:""},footerClass:{type:String,default:""}},emits:["click"],setup(e,{emit:r}){const t=e,a=p(()=>{const i=["relative bg-white transition-all duration-200"],v={none:"rounded-none",sm:"rounded-sm",md:"rounded-md",lg:"rounded-lg",xl:"rounded-xl"};i.push(v[t.rounded]);const b={default:"border border-gray-200",bordered:"border-2 border-gray-300",elevated:"shadow-lg",flat:""};return i.push(b[t.variant]),t.hoverable&&i.push("hover:shadow-xl hover:scale-[1.02]"),t.clickable&&i.push("cursor-pointer hover:shadow-md"),t.loading&&i.push("overflow-hidden"),i.join(" ")});return(i,v)=>(c(),u("div",{class:$(a.value)},[e.title||i.$slots.header||i.$slots.actions?(c(),u("div",{key:0,class:$(["flex items-center justify-between",e.headerClass||"px-6 py-4 border-b border-gray-200"])},[A(i.$slots,"header",{},()=>[n("div",me,[e.icon?(c(),E(R(e.icon),{key:0,class:"w-6 h-6 text-gray-600"})):C("",!0),n("div",null,[n("h3",he,S(e.title),1),e.subtitle?(c(),u("p",pe,S(e.subtitle),1)):C("",!0)])])]),i.$slots.actions?(c(),u("div",ve,[A(i.$slots,"actions",{},void 0)])):C("",!0)],2)):C("",!0),n("div",{class:$(e.bodyClass||"px-6 py-4")},[A(i.$slots,"default",{},void 0)],2),i.$slots.footer?(c(),u("div",{key:1,class:$(e.footerClass||"px-6 py-4 border-t border-gray-200 bg-gray-50")},[A(i.$slots,"footer",{},void 0)],2)):C("",!0),e.loading?(c(),u("div",xe,[x(q,{type:"spinner",size:"lg"})])):C("",!0)],2))}},_=O(be,[["__scopeId","data-v-51e49d88"]]);/**
 * @license lucide-vue-next v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),we=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(r,t,a)=>a?a.toUpperCase():t.toLowerCase()),ke=e=>{const r=we(e);return r.charAt(0).toUpperCase()+r.slice(1)},Ce=(...e)=>e.filter((r,t,a)=>!!r&&r.trim()!==""&&a.indexOf(r)===t).join(" ").trim(),Q=e=>e==="";/**
 * @license lucide-vue-next v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var V={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};/**
 * @license lucide-vue-next v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=({name:e,iconNode:r,absoluteStrokeWidth:t,"absolute-stroke-width":a,strokeWidth:i,"stroke-width":v,size:b=V.width,color:o=V.stroke,...m},{slots:y})=>U("svg",{...V,...m,width:b,height:b,stroke:o,"stroke-width":Q(t)||Q(a)||t===!0||a===!0?Number(i||v||V["stroke-width"])*24/Number(b):i||v||V["stroke-width"],class:Ce("lucide",m.class,...e?[`lucide-${G(ke(e))}-icon`,`lucide-${G(e)}`]:["lucide-icon"])},[...r.map(s=>U(...s)),...y.default?[y.default()]:[]]);/**
 * @license lucide-vue-next v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=(e,r)=>(t,{slots:a,attrs:i})=>U(Se,{...i,...t,iconNode:r,name:e},a);/**
 * @license lucide-vue-next v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=L("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-vue-next v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=L("clipboard-check",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-vue-next v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=L("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-vue-next v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=L("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-vue-next v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=L("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),ze=H("incident",()=>{const e=I([]),r=I([]),t=I(!1),a=I(null),i=p(()=>e.value.length),v=p(()=>e.value.filter(l=>l.severity==="critical").length),b=p(()=>e.value.filter(l=>l.status==="open"||l.status==="investigating"));async function o(l={}){t.value=!0,a.value=null;try{const d=await z.call({method:"tems.api.pwa.safety.get_incidents",args:{filters:l}});return e.value=d.message||[],e.value}catch(d){throw a.value=d.message,d}finally{t.value=!1}}async function m(){t.value=!0,a.value=null;try{const l=await z.call({method:"tems.api.pwa.safety.get_critical_incidents",args:{}});return r.value=l.message||[],r.value}catch(l){throw a.value=l.message,l}finally{t.value=!1}}async function y(l){t.value=!0,a.value=null;try{const w=(await z.call({method:"tems.api.pwa.safety.report_incident",args:{incident_data:l}})).message;return e.value.unshift(w),w}catch(d){throw a.value=d.message,d}finally{t.value=!1}}async function s(l,d,w=""){try{const k=await z.call({method:"tems.api.pwa.safety.update_incident_status",args:{incident_id:l,status:d,notes:w}}),j=e.value.findIndex(F=>F.name===l);return j!==-1&&(e.value[j].status=d),k.message}catch(k){throw a.value=k.message,k}}async function f(l,d){try{const w=await z.call({method:"tems.api.pwa.safety.assign_investigator",args:{incident_id:l,investigator_id:d}}),k=e.value.findIndex(j=>j.name===l);return k!==-1&&(e.value[k].investigator=d),w.message}catch(w){throw a.value=w.message,w}}function h(){a.value=null}return{incidents:e,criticalIncidents:r,loading:t,error:a,totalIncidents:i,criticalCount:v,openIncidents:b,fetchIncidents:o,fetchCriticalIncidents:m,reportIncident:y,updateIncidentStatus:s,assignInvestigator:f,clearError:h}}),Be=H("audit",()=>{const e=I([]),r=I([]),t=I(!1),a=I(null),i=p(()=>e.value.length),v=p(()=>e.value.filter(h=>h.status==="completed").length),b=p(()=>e.value.filter(h=>h.status==="scheduled"||h.status==="in_progress"));async function o(h={}){t.value=!0,a.value=null;try{const l=await z.call({method:"tems.api.pwa.safety.get_audits",args:{filters:h}});return e.value=l.message||[],e.value}catch(l){throw a.value=l.message,l}finally{t.value=!1}}async function m(){t.value=!0,a.value=null;try{const h=await z.call({method:"tems.api.pwa.safety.get_upcoming_audits",args:{}});return r.value=h.message||[],r.value}catch(h){throw a.value=h.message,h}finally{t.value=!1}}async function y(h){t.value=!0,a.value=null;try{const d=(await z.call({method:"tems.api.pwa.safety.schedule_audit",args:{audit_data:h}})).message;return e.value.unshift(d),d}catch(l){throw a.value=l.message,l}finally{t.value=!1}}async function s(h,l){try{const d=await z.call({method:"tems.api.pwa.safety.submit_audit_findings",args:{audit_id:h,findings:l}}),w=e.value.findIndex(k=>k.name===h);return w!==-1&&(e.value[w].status="completed",e.value[w].findings=l),d.message}catch(d){throw a.value=d.message,d}}function f(){a.value=null}return{audits:e,upcomingAudits:r,loading:t,error:a,totalAudits:i,completedAudits:v,pendingAudits:b,fetchAudits:o,fetchUpcomingAudits:m,scheduleAudit:y,submitAuditFindings:s,clearError:f}}),je=H("compliance",()=>{const e=I([]),r=I([]),t=I(!1),a=I(null),i=p(()=>e.value.length),v=p(()=>e.value.filter(l=>l.status==="compliant").length),b=p(()=>e.value.filter(l=>l.status==="non_compliant").length),o=p(()=>i.value===0?0:(v.value/i.value*100).toFixed(1));async function m(l={}){t.value=!0,a.value=null;try{const d=await z.call({method:"tems.api.pwa.safety.get_compliance_items",args:{filters:l}});return e.value=d.message||[],e.value}catch(d){throw a.value=d.message,d}finally{t.value=!1}}async function y(l=30){t.value=!0,a.value=null;try{const d=await z.call({method:"tems.api.pwa.safety.get_expiring_compliance",args:{days:l}});return r.value=d.message||[],r.value}catch(d){throw a.value=d.message,d}finally{t.value=!1}}async function s(l,d,w=""){try{const k=await z.call({method:"tems.api.pwa.safety.update_compliance_status",args:{item_id:l,status:d,notes:w}}),j=e.value.findIndex(F=>F.name===l);return j!==-1&&(e.value[j].status=d),k.message}catch(k){throw a.value=k.message,k}}async function f(l,d){try{const w=await z.call({method:"tems.api.pwa.safety.renew_compliance",args:{item_id:l,expiry_date:d}}),k=e.value.findIndex(j=>j.name===l);return k!==-1&&(e.value[k].expiry_date=d,e.value[k].status="compliant"),w.message}catch(w){throw a.value=w.message,w}}function h(){a.value=null}return{complianceItems:e,expiringItems:r,loading:t,error:a,totalItems:i,compliantCount:v,nonCompliantCount:b,complianceRate:o,fetchComplianceItems:m,fetchExpiringItems:y,updateComplianceStatus:s,renewCompliance:f,clearError:h}}),Me={class:"min-h-screen bg-gray-50"},Ae={class:"max-w-7xl mx-auto px-4 py-6 space-y-8"},_e={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},Ee={class:"flex items-center justify-between"},Re={class:"text-3xl font-bold text-primary-600"},Ve={class:"flex items-center justify-between"},Le={class:"text-3xl font-bold text-error"},Ne={class:"flex items-center justify-between"},De={class:"text-3xl font-bold text-success"},Oe={class:"flex items-center justify-between"},Fe={class:"text-3xl font-bold text-warning"},Pe={class:"mb-8"},Ue={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},qe={class:"mb-8"},He={class:"text-lg font-semibold text-gray-900 mb-4 flex items-center"},Te={key:0,class:"text-center py-8"},Ze={key:1,class:"text-center py-8 text-gray-500"},Ge={key:2,class:"space-y-4"},Qe={class:"font-medium text-gray-900"},Je={class:"text-sm text-gray-600"},Xe={key:0,class:"text-center py-8"},Ye={key:1,class:"text-center py-8 text-gray-500"},Ke={key:2,class:"space-y-4"},We={class:"font-medium text-gray-900"},et={class:"text-sm text-gray-600"},nt={__name:"Dashboard",setup(e){const r=te(),t=ze(),a=Be(),i=je(),v=p(()=>t.criticalIncidents.slice(0,5)),b=p(()=>i.expiringItems.slice(0,5)),o=I(!0),m=I(null);return ee(async()=>{try{await Promise.all([t.fetchCriticalIncidents().catch(y=>console.warn("Critical incidents fetch error:",y)),t.fetchIncidents({limit:10}).catch(y=>console.warn("Incidents fetch error:",y)),a.fetchUpcomingAudits().catch(y=>console.warn("Audits fetch error:",y)),i.fetchExpiringItems(30).catch(y=>console.warn("Expiring items fetch error:",y)),i.fetchComplianceItems().catch(y=>console.warn("Compliance items fetch error:",y))])}catch(y){m.value=y.message,console.error("Dashboard data fetch error:",y)}finally{o.value=!1}}),(y,s)=>(c(),u("div",Me,[s[14]||(s[14]=n("div",{class:"bg-white border-b border-gray-200 px-4 py-6"},[n("div",{class:"max-w-7xl mx-auto"},[n("h1",{class:"text-2xl font-bold text-gray-900"},"Safety Dashboard"),n("p",{class:"text-sm text-gray-600 mt-1"},"Incident Management & Safety Compliance")])],-1)),n("div",Ae,[n("div",_e,[x(g(_),null,{default:B(()=>[n("div",Ee,[n("div",null,[s[3]||(s[3]=n("p",{class:"text-sm text-gray-600"},"Open Incidents",-1)),n("p",Re,S(g(t).openIncidents.length),1)]),x(g(Y),{class:"w-12 h-12 text-primary-400"})])]),_:1}),x(g(_),null,{default:B(()=>[n("div",Ve,[n("div",null,[s[4]||(s[4]=n("p",{class:"text-sm text-gray-600"},"Critical Incidents",-1)),n("p",Le,S(g(t).criticalCount),1)]),x(g($e),{class:"w-12 h-12 text-error"})])]),_:1}),x(g(_),null,{default:B(()=>[n("div",Ne,[n("div",null,[s[5]||(s[5]=n("p",{class:"text-sm text-gray-600"},"Compliance Rate",-1)),n("p",De,S(g(i).complianceRate)+"%",1)]),x(g(X),{class:"w-12 h-12 text-success"})])]),_:1}),x(g(_),null,{default:B(()=>[n("div",Oe,[n("div",null,[s[6]||(s[6]=n("p",{class:"text-sm text-gray-600"},"Pending Audits",-1)),n("p",Fe,S(g(a).pendingAudits.length),1)]),x(g(J),{class:"w-12 h-12 text-warning"})])]),_:1})]),n("div",Pe,[s[10]||(s[10]=n("h2",{class:"text-xl font-semibold text-gray-900 mb-4"},"Quick Actions",-1)),n("div",Ue,[x(g(P),{variant:"primary",onClick:s[0]||(s[0]=f=>g(r).push("/incidents")),class:"py-6"},{default:B(()=>[x(g(Ie),{class:"w-5 h-5 mr-2"}),s[7]||(s[7]=M(" Report Incident ",-1))]),_:1}),x(g(P),{variant:"secondary",onClick:s[1]||(s[1]=f=>g(r).push("/audits")),class:"py-6"},{default:B(()=>[x(g(J),{class:"w-5 h-5 mr-2"}),s[8]||(s[8]=M(" Schedule Audit ",-1))]),_:1}),x(g(P),{variant:"secondary",onClick:s[2]||(s[2]=f=>g(r).push("/compliance")),class:"py-6"},{default:B(()=>[x(g(X),{class:"w-5 h-5 mr-2"}),s[9]||(s[9]=M(" Check Compliance ",-1))]),_:1})])]),n("div",qe,[x(g(_),null,{default:B(()=>[n("h3",He,[x(g(Y),{class:"w-5 h-5 text-primary-600 mr-2"}),s[11]||(s[11]=M(" Critical Incidents ",-1))]),g(t).loading?(c(),u("div",Te,[x(g(q))])):v.value.length===0?(c(),u("div",Ze," No critical incidents ")):(c(),u("div",Ge,[(c(!0),u(N,null,D(v.value,f=>(c(),u("div",{key:f.name,class:"flex items-center justify-between p-4 border border-red-200 bg-red-50 rounded-lg hover:bg-red-100"},[n("div",null,[n("h4",Qe,S(f.title),1),n("p",Je,S(f.location)+" â€¢ "+S(f.reported_by),1)]),x(g(Z),{variant:"error"},{default:B(()=>[M(S(f.status),1)]),_:2},1024)]))),128))]))]),_:1})]),n("div",null,[s[13]||(s[13]=n("h2",{class:"text-xl font-semibold text-gray-900 mb-4"},"Expiring Compliance",-1)),x(g(_),null,{default:B(()=>[g(i).loading?(c(),u("div",Xe,[x(g(q))])):b.value.length===0?(c(),u("div",Ye," No items expiring soon ")):(c(),u("div",Ke,[(c(!0),u(N,null,D(b.value,f=>(c(),u("div",{key:f.name,class:"flex items-center justify-between p-4 border border-gray-200 rounded-lg hover:bg-gray-50"},[n("div",null,[n("h4",We,S(f.title),1),n("p",et,"Expires: "+S(g(le)(f.expiry_date)),1)]),x(g(Z),{variant:"warning"},{default:B(()=>[...s[12]||(s[12]=[M(" Expiring Soon ",-1)])]),_:1})]))),128))]))]),_:1})])])]))}};export{nt as default};
//# sourceMappingURL=Dashboard-BUjUSF5b.js.map
