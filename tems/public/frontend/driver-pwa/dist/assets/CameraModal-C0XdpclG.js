import{r as h,k as x,H as M,z as V,p as j,o as y,i as E,a as s,c as C,d as k,m as n,h as w,t as B}from"./vue-vendor-85nDNI24.js";import{M as U}from"./Modal-BTglq67a.js";import{R as D}from"./refresh-cw-BAKKBxtm.js";import{c as F}from"./createLucideIcon-TnRFscOj.js";import{X as z}from"./x-BTU5YQqX.js";/**
 * @license lucide-vue-next v0.545.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=F("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);function H(){const t=h(null),a=h(null),l=h(null),o=h(!1),i=x(()=>!!(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia));async function u(e,d="environment"){if(!i.value)throw l.value=new Error("Camera not supported on this device"),l.value;try{const r={video:{facingMode:d,width:{ideal:1920},height:{ideal:1080}},audio:!1};return t.value=await navigator.mediaDevices.getUserMedia(r),e&&(a.value=e,e.srcObject=t.value,await e.play(),o.value=!0),t.value}catch(r){throw l.value=r,r}}function v(){t.value&&(t.value.getTracks().forEach(e=>e.stop()),t.value=null,o.value=!1),a.value&&(a.value.srcObject=null)}function f(){if(!a.value||!o.value)throw new Error("Camera not active");const e=document.createElement("canvas");return e.width=a.value.videoWidth,e.height=a.value.videoHeight,e.getContext("2d").drawImage(a.value,0,0),new Promise(r=>{e.toBlob(g=>{r({blob:g,dataUrl:e.toDataURL("image/jpeg",.9)})},"image/jpeg",.9)})}async function p(){if(!o.value)return;const d=t.value.getVideoTracks()[0].getSettings().facingMode==="user"?"environment":"user";v(),await u(a.value,d)}return{stream:t,videoElement:a,error:l,isActive:o,isCameraSupported:i,startCamera:u,stopCamera:v,capturePhoto:f,switchCamera:p}}const P={class:"space-y-4"},I={class:"relative bg-black rounded-lg overflow-hidden",style:{"aspect-ratio":"4/3"}},N={key:0,class:"absolute inset-0 flex items-center justify-center bg-black/50"},S={class:"flex items-center justify-center space-x-4"},T=["disabled"],L=["disabled"],O={key:0,class:"text-sm text-red-600 text-center"},K={__name:"CameraModal",props:{modelValue:{type:Boolean,required:!0}},emits:["update:modelValue","capture"],setup(t,{emit:a}){const l=t,o=a,i=h(null),{isActive:u,error:v,startCamera:f,stopCamera:p,capturePhoto:e,switchCamera:d}=H();M(()=>l.modelValue,async c=>{if(c&&i.value)try{await f(i.value)}catch(m){console.error("Failed to start camera:",m)}else c||p()});async function r(){await d()}async function g(){try{const c=await e();o("capture",c),b()}catch(c){console.error("Failed to capture photo:",c)}}function b(){p(),o("update:modelValue",!1)}return V(()=>{p()}),(c,m)=>(y(),j(U,{"model-value":t.modelValue,"onUpdate:modelValue":m[0]||(m[0]=_=>o("update:modelValue",_)),title:"Take Photo",size:"lg","full-height":""},{default:E(()=>[s("div",P,[s("div",I,[s("video",{ref_key:"videoElement",ref:i,autoplay:"",playsinline:"",class:"w-full h-full object-cover"},null,512),n(u)?k("",!0):(y(),C("div",N,[...m[1]||(m[1]=[s("p",{class:"text-white"},"Initializing camera...",-1)])]))]),s("div",S,[s("button",{type:"button",onClick:r,class:"btn-secondary p-3",disabled:!n(u)},[w(n(D),{class:"w-6 h-6"})],8,T),s("button",{type:"button",onClick:g,class:"w-16 h-16 bg-primary-600 hover:bg-primary-700 rounded-full flex items-center justify-center shadow-lg active:scale-95 transition-transform",disabled:!n(u)},[w(n(A),{class:"w-8 h-8 text-white"})],8,L),s("button",{type:"button",onClick:b,class:"btn-secondary p-3"},[w(n(z),{class:"w-6 h-6"})])]),n(v)?(y(),C("p",O,B(n(v)),1)):k("",!0)])]),_:1},8,["model-value"]))}};export{A as C,K as _};
//# sourceMappingURL=CameraModal-C0XdpclG.js.map
