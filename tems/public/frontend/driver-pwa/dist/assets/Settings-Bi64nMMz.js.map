{"version":3,"mappings":"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","names":["useNotifications","permission","ref","isSupported","serviceWorkerRegistration","requestPermission","result","error","showNotification","title","options","defaultOptions","areNotificationsEnabled","getServiceWorkerRegistration","subscribeToPush","vapidPublicKey","urlBase64ToUint8Array","unsubscribeFromPush","subscription","base64String","padding","base64","rawData","outputArray","i","onMounted","interval","onUnmounted","Download","createLucideIcon","LogOut","Trash2","authStore","useAuthStore","offlineStore","useOfflineStore","downloading","showToast","toastType","toastTitle","toastMessage","notificationsEnabled","soundEnabled","vibrationEnabled","locationEnabled","highAccuracyMode","buildNumber","formatLastSync","computed","formatDistanceToNow","syncOfflineData","downloadOfflineData","toggleNotifications","clearCache","frappeClient","__vitePreload","logout","prefs","parsed","watch","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_cache","_createVNode","StatusBadge","_unref","_hoisted_4","_hoisted_5","_hoisted_6","_toDisplayString","_hoisted_7","_hoisted_8","CheckCircle","RefreshCw","_normalizeClass","_createTextVNode","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","$event","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","Toast"],"ignoreList":[1,2,3],"sources":["../../../../../../frontend/shared/src/composables/useNotifications.js","../../../../../../frontend/node_modules/lucide-vue-next/dist/esm/icons/download.js","../../../../../../frontend/node_modules/lucide-vue-next/dist/esm/icons/log-out.js","../../../../../../frontend/node_modules/lucide-vue-next/dist/esm/icons/trash-2.js","../../../../../../frontend/driver-pwa/src/views/Settings.vue"],"sourcesContent":["import { ref, onMounted, onUnmounted } from 'vue'\n\n/**\n * Push notifications composable\n * Handles push notification permissions and subscriptions\n * \n * @returns {object} Notification state and methods\n * \n * @example\n * ```javascript\n * import { useNotifications } from '@shared/composables/useNotifications'\n * \n * const { \n *   permission, \n *   isSupported, \n *   requestPermission,\n *   showNotification \n * } = useNotifications()\n * \n * // Request permission\n * await requestPermission()\n * \n * // Show notification\n * showNotification('New Message', {\n *   body: 'You have a new message',\n *   icon: '/icon.png',\n *   badge: '/badge.png'\n * })\n * ```\n */\nexport function useNotifications() {\n    const permission = ref(Notification?.permission || 'default')\n    const isSupported = ref('Notification' in window)\n    const serviceWorkerRegistration = ref(null)\n\n    /**\n     * Request notification permission\n     * @returns {Promise<string>} Permission status\n     */\n    async function requestPermission() {\n        if (!isSupported.value) {\n            throw new Error('Notifications are not supported')\n        }\n\n        if (permission.value === 'granted') {\n            return 'granted'\n        }\n\n        try {\n            const result = await Notification.requestPermission()\n            permission.value = result\n            return result\n        } catch (error) {\n            console.error('Error requesting notification permission:', error)\n            throw error\n        }\n    }\n\n    /**\n     * Show a notification\n     * @param {string} title - Notification title\n     * @param {object} options - Notification options\n     * @returns {Notification}\n     */\n    function showNotification(title, options = {}) {\n        if (!isSupported.value) {\n            console.warn('Notifications are not supported')\n            return null\n        }\n\n        if (permission.value !== 'granted') {\n            console.warn('Notification permission not granted')\n            return null\n        }\n\n        const defaultOptions = {\n            icon: '/assets/tems/frontend/driver-pwa/dist/pwa-192x192.png',\n            badge: '/assets/tems/frontend/driver-pwa/dist/pwa-192x192.png',\n            vibrate: [200, 100, 200],\n            requireInteraction: false,\n            ...options\n        }\n\n        // Use service worker if available (better for PWAs)\n        if (serviceWorkerRegistration.value) {\n            return serviceWorkerRegistration.value.showNotification(title, defaultOptions)\n        }\n\n        // Fallback to regular notification\n        return new Notification(title, defaultOptions)\n    }\n\n    /**\n     * Check if notifications are enabled\n     * @returns {boolean}\n     */\n    function areNotificationsEnabled() {\n        return isSupported.value && permission.value === 'granted'\n    }\n\n    /**\n     * Get service worker registration\n     */\n    async function getServiceWorkerRegistration() {\n        if ('serviceWorker' in navigator) {\n            try {\n                serviceWorkerRegistration.value = await navigator.serviceWorker.ready\n            } catch (error) {\n                console.error('Error getting service worker:', error)\n            }\n        }\n    }\n\n    /**\n     * Subscribe to push notifications\n     * @param {string} vapidPublicKey - VAPID public key\n     * @returns {Promise<PushSubscription>}\n     */\n    async function subscribeToPush(vapidPublicKey) {\n        if (!serviceWorkerRegistration.value) {\n            await getServiceWorkerRegistration()\n        }\n\n        if (!serviceWorkerRegistration.value) {\n            throw new Error('Service worker not available')\n        }\n\n        try {\n            const subscription = await serviceWorkerRegistration.value.pushManager.subscribe({\n                userVisibleOnly: true,\n                applicationServerKey: urlBase64ToUint8Array(vapidPublicKey)\n            })\n\n            return subscription\n        } catch (error) {\n            console.error('Error subscribing to push:', error)\n            throw error\n        }\n    }\n\n    /**\n     * Unsubscribe from push notifications\n     */\n    async function unsubscribeFromPush() {\n        if (!serviceWorkerRegistration.value) {\n            return\n        }\n\n        try {\n            const subscription = await serviceWorkerRegistration.value.pushManager.getSubscription()\n            if (subscription) {\n                await subscription.unsubscribe()\n            }\n        } catch (error) {\n            console.error('Error unsubscribing from push:', error)\n            throw error\n        }\n    }\n\n    /**\n     * Convert base64 VAPID key to Uint8Array\n     * @private\n     */\n    function urlBase64ToUint8Array(base64String) {\n        const padding = '='.repeat((4 - base64String.length % 4) % 4)\n        const base64 = (base64String + padding)\n            .replace(/\\-/g, '+')\n            .replace(/_/g, '/')\n\n        const rawData = window.atob(base64)\n        const outputArray = new Uint8Array(rawData.length)\n\n        for (let i = 0; i < rawData.length; ++i) {\n            outputArray[i] = rawData.charCodeAt(i)\n        }\n        return outputArray\n    }\n\n    // Initialize service worker on mount\n    onMounted(() => {\n        getServiceWorkerRegistration()\n    })\n\n    // Update permission when it changes\n    onMounted(() => {\n        if (isSupported.value) {\n            // Check permission periodically\n            const interval = setInterval(() => {\n                permission.value = Notification.permission\n            }, 1000)\n\n            onUnmounted(() => {\n                clearInterval(interval)\n            })\n        }\n    })\n\n    return {\n        // State\n        permission,\n        isSupported,\n        serviceWorkerRegistration,\n\n        // Methods\n        requestPermission,\n        showNotification,\n        areNotificationsEnabled,\n        subscribeToPush,\n        unsubscribeFromPush\n    }\n}\n","/**\n * @license lucide-vue-next v0.545.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Download = createLucideIcon(\"download\", [\n  [\"path\", { d: \"M12 15V3\", key: \"m9g1x1\" }],\n  [\"path\", { d: \"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\", key: \"ih7n3h\" }],\n  [\"path\", { d: \"m7 10 5 5 5-5\", key: \"brsn70\" }]\n]);\n\nexport { Download as default };\n//# sourceMappingURL=download.js.map\n","/**\n * @license lucide-vue-next v0.545.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst LogOut = createLucideIcon(\"log-out\", [\n  [\"path\", { d: \"m16 17 5-5-5-5\", key: \"1bji2h\" }],\n  [\"path\", { d: \"M21 12H9\", key: \"dn1m92\" }],\n  [\"path\", { d: \"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4\", key: \"1uf3rs\" }]\n]);\n\nexport { LogOut as default };\n//# sourceMappingURL=log-out.js.map\n","/**\n * @license lucide-vue-next v0.545.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Trash2 = createLucideIcon(\"trash-2\", [\n  [\"path\", { d: \"M10 11v6\", key: \"nco0om\" }],\n  [\"path\", { d: \"M14 11v6\", key: \"outv1u\" }],\n  [\"path\", { d: \"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6\", key: \"miytrc\" }],\n  [\"path\", { d: \"M3 6h18\", key: \"d0wm0j\" }],\n  [\"path\", { d: \"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\", key: \"e791ji\" }]\n]);\n\nexport { Trash2 as default };\n//# sourceMappingURL=trash-2.js.map\n","<template>\n  <div class=\"space-y-6\">\n    <!-- Header -->\n    <div class=\"card p-4\">\n      <h2 class=\"text-xl font-bold text-gray-900 mb-2\">Settings</h2>\n      <p class=\"text-sm text-gray-600\">Manage your app preferences</p>\n    </div>\n\n    <!-- Sync Status -->\n    <div class=\"card p-4\">\n      <div class=\"flex items-center justify-between mb-4\">\n        <h3 class=\"font-semibold text-gray-900\">Offline Data</h3>\n        <StatusBadge :status=\"offlineStore.isOnline ? 'Online' : 'Offline'\" />\n      </div>\n\n      <div class=\"space-y-3\">\n        <div class=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\">\n          <div>\n            <p class=\"text-sm font-medium text-gray-900\">Pending Sync</p>\n            <p class=\"text-xs text-gray-600\">Data waiting to be uploaded</p>\n          </div>\n          <span class=\"text-lg font-bold text-primary-600\">{{ offlineStore.pendingSync }}</span>\n        </div>\n\n        <div v-if=\"offlineStore.lastSyncTime\" class=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\">\n          <div>\n            <p class=\"text-sm font-medium text-gray-900\">Last Sync</p>\n            <p class=\"text-xs text-gray-600\">{{ formatLastSync }}</p>\n          </div>\n          <CheckCircle class=\"w-5 h-5 text-green-600\" />\n        </div>\n\n        <button\n          @click=\"syncOfflineData\"\n          class=\"w-full btn-primary py-3\"\n          :disabled=\"!offlineStore.isOnline || offlineStore.syncInProgress\"\n        >\n          <RefreshCw class=\"w-5 h-5 mr-2\" :class=\"{ 'animate-spin': offlineStore.syncInProgress }\" />\n          {{ offlineStore.syncInProgress ? 'Syncing...' : 'Sync Now' }}\n        </button>\n\n        <button\n          @click=\"downloadOfflineData\"\n          class=\"w-full btn-secondary py-3\"\n          :disabled=\"!offlineStore.isOnline || downloading\"\n        >\n          <Download class=\"w-5 h-5 mr-2\" :class=\"{ 'animate-spin': downloading }\" />\n          {{ downloading ? 'Downloading...' : 'Download for Offline Use' }}\n        </button>\n      </div>\n    </div>\n\n    <!-- Notification Settings -->\n    <div class=\"card p-4\">\n      <h3 class=\"font-semibold text-gray-900 mb-4\">Notifications</h3>\n\n      <div class=\"space-y-3\">\n        <div class=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\">\n          <div>\n            <p class=\"text-sm font-medium text-gray-900\">Push Notifications</p>\n            <p class=\"text-xs text-gray-600\">Receive alerts and updates</p>\n          </div>\n          <button\n            @click=\"toggleNotifications\"\n            class=\"relative inline-flex h-6 w-11 items-center rounded-full transition-colors\"\n            :class=\"notificationsEnabled ? 'bg-primary-600' : 'bg-gray-200'\"\n          >\n            <span\n              class=\"inline-block h-4 w-4 transform rounded-full bg-white transition-transform\"\n              :class=\"notificationsEnabled ? 'translate-x-6' : 'translate-x-1'\"\n            ></span>\n          </button>\n        </div>\n\n        <div class=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\">\n          <div>\n            <p class=\"text-sm font-medium text-gray-900\">Sound Alerts</p>\n            <p class=\"text-xs text-gray-600\">Play sound for notifications</p>\n          </div>\n          <button\n            @click=\"soundEnabled = !soundEnabled\"\n            class=\"relative inline-flex h-6 w-11 items-center rounded-full transition-colors\"\n            :class=\"soundEnabled ? 'bg-primary-600' : 'bg-gray-200'\"\n          >\n            <span\n              class=\"inline-block h-4 w-4 transform rounded-full bg-white transition-transform\"\n              :class=\"soundEnabled ? 'translate-x-6' : 'translate-x-1'\"\n            ></span>\n          </button>\n        </div>\n\n        <div class=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\">\n          <div>\n            <p class=\"text-sm font-medium text-gray-900\">Vibration</p>\n            <p class=\"text-xs text-gray-600\">Vibrate for important alerts</p>\n          </div>\n          <button\n            @click=\"vibrationEnabled = !vibrationEnabled\"\n            class=\"relative inline-flex h-6 w-11 items-center rounded-full transition-colors\"\n            :class=\"vibrationEnabled ? 'bg-primary-600' : 'bg-gray-200'\"\n          >\n            <span\n              class=\"inline-block h-4 w-4 transform rounded-full bg-white transition-transform\"\n              :class=\"vibrationEnabled ? 'translate-x-6' : 'translate-x-1'\"\n            ></span>\n          </button>\n        </div>\n      </div>\n    </div>\n\n    <!-- Location Settings -->\n    <div class=\"card p-4\">\n      <h3 class=\"font-semibold text-gray-900 mb-4\">Location</h3>\n\n      <div class=\"space-y-3\">\n        <div class=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\">\n          <div>\n            <p class=\"text-sm font-medium text-gray-900\">Location Tracking</p>\n            <p class=\"text-xs text-gray-600\">Track location during trips</p>\n          </div>\n          <button\n            @click=\"locationEnabled = !locationEnabled\"\n            class=\"relative inline-flex h-6 w-11 items-center rounded-full transition-colors\"\n            :class=\"locationEnabled ? 'bg-primary-600' : 'bg-gray-200'\"\n          >\n            <span\n              class=\"inline-block h-4 w-4 transform rounded-full bg-white transition-transform\"\n              :class=\"locationEnabled ? 'translate-x-6' : 'translate-x-1'\"\n            ></span>\n          </button>\n        </div>\n\n        <div class=\"flex items-center justify-between p-3 bg-gray-50 rounded-lg\">\n          <div>\n            <p class=\"text-sm font-medium text-gray-900\">High Accuracy Mode</p>\n            <p class=\"text-xs text-gray-600\">Use GPS for precise location</p>\n          </div>\n          <button\n            @click=\"highAccuracyMode = !highAccuracyMode\"\n            class=\"relative inline-flex h-6 w-11 items-center rounded-full transition-colors\"\n            :class=\"highAccuracyMode ? 'bg-primary-600' : 'bg-gray-200'\"\n          >\n            <span\n              class=\"inline-block h-4 w-4 transform rounded-full bg-white transition-transform\"\n              :class=\"highAccuracyMode ? 'translate-x-6' : 'translate-x-1'\"\n            ></span>\n          </button>\n        </div>\n      </div>\n    </div>\n\n    <!-- App Info -->\n    <div class=\"card p-4\">\n      <h3 class=\"font-semibold text-gray-900 mb-4\">App Information</h3>\n\n      <div class=\"space-y-2 text-sm\">\n        <div class=\"flex justify-between\">\n          <span class=\"text-gray-600\">Version</span>\n          <span class=\"font-medium text-gray-900\">1.0.0</span>\n        </div>\n        <div class=\"flex justify-between\">\n          <span class=\"text-gray-600\">Build</span>\n          <span class=\"font-medium text-gray-900\">{{ buildNumber }}</span>\n        </div>\n        <div class=\"flex justify-between\">\n          <span class=\"text-gray-600\">Last Updated</span>\n          <span class=\"font-medium text-gray-900\">Oct 2025</span>\n        </div>\n      </div>\n    </div>\n\n    <!-- Cache Management -->\n    <div class=\"card p-4\">\n      <h3 class=\"font-semibold text-gray-900 mb-4\">Storage</h3>\n\n      <button\n        @click=\"clearCache\"\n        class=\"w-full btn-secondary py-3 text-red-600 hover:bg-red-50\"\n      >\n        <Trash2 class=\"w-5 h-5 mr-2\" />\n        Clear Cache\n      </button>\n    </div>\n\n    <!-- Logout -->\n    <div class=\"card p-4\">\n      <button\n        @click=\"logout\"\n        class=\"w-full btn-secondary py-3 text-red-600 hover:bg-red-50\"\n      >\n        <LogOut class=\"w-5 h-5 mr-2\" />\n        Logout\n      </button>\n    </div>\n\n    <!-- Toast -->\n    <Toast\n      v-model=\"showToast\"\n      :type=\"toastType\"\n      :title=\"toastTitle\"\n      :message=\"toastMessage\"\n    />\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted } from 'vue'\nimport { formatDistanceToNow } from 'date-fns'\nimport { \n  RefreshCw, Download, CheckCircle, Trash2, LogOut \n} from 'lucide-vue-next'\nimport { useAuth as useAuthStore } from '@shared'\nimport { useOfflineStore } from '@shared'\nimport { useNotifications } from '@shared'\nimport StatusBadge from '@/components/common/StatusBadge.vue'\nimport Toast from '@/components/common/Toast.vue'\n\nconst authStore = useAuthStore()\nconst offlineStore = useOfflineStore()\nconst { permission, requestPermission } = useNotifications()\n\nconst downloading = ref(false)\nconst showToast = ref(false)\nconst toastType = ref('success')\nconst toastTitle = ref('')\nconst toastMessage = ref('')\n\nconst notificationsEnabled = ref(permission.value === 'granted')\nconst soundEnabled = ref(true)\nconst vibrationEnabled = ref(true)\nconst locationEnabled = ref(true)\nconst highAccuracyMode = ref(true)\nconst buildNumber = ref('20251013')\n\nconst formatLastSync = computed(() => {\n  if (!offlineStore.lastSyncTime) return 'Never'\n  try {\n    return formatDistanceToNow(offlineStore.lastSyncTime, { addSuffix: true })\n  } catch (e) {\n    return 'Unknown'\n  }\n})\n\nasync function syncOfflineData() {\n  try {\n    const result = await offlineStore.syncOfflineData()\n    \n    toastType.value = 'success'\n    toastTitle.value = 'Sync Complete'\n    toastMessage.value = `Synced ${result.synced} items successfully`\n    showToast.value = true\n  } catch (error) {\n    toastType.value = 'error'\n    toastTitle.value = 'Sync Failed'\n    toastMessage.value = error.message || 'Failed to sync data'\n    showToast.value = true\n  }\n}\n\nasync function downloadOfflineData() {\n  downloading.value = true\n  \n  try {\n    await offlineStore.downloadOfflineData()\n    \n    toastType.value = 'success'\n    toastTitle.value = 'Download Complete'\n    toastMessage.value = 'Offline data downloaded successfully'\n    showToast.value = true\n  } catch (error) {\n    toastType.value = 'error'\n    toastTitle.value = 'Download Failed'\n    toastMessage.value = error.message || 'Failed to download data'\n    showToast.value = true\n  } finally {\n    downloading.value = false\n  }\n}\n\nasync function toggleNotifications() {\n  if (!notificationsEnabled.value) {\n    const result = await requestPermission()\n    notificationsEnabled.value = result === 'granted'\n    \n    if (!notificationsEnabled.value) {\n      toastType.value = 'warning'\n      toastTitle.value = 'Permission Denied'\n      toastMessage.value = 'Enable notifications in browser settings'\n      showToast.value = true\n    }\n  } else {\n    notificationsEnabled.value = false\n  }\n}\n\nasync function clearCache() {\n  if (confirm('Are you sure you want to clear all cached data? This cannot be undone.')) {\n    try {\n      // Clear cache via frappe client\n      const { frappeClient } = await import('@shared')\n      await frappeClient.clearCache()\n      \n      toastType.value = 'success'\n      toastTitle.value = 'Cache Cleared'\n      toastMessage.value = 'All cached data has been cleared'\n      showToast.value = true\n    } catch (error) {\n      toastType.value = 'error'\n      toastTitle.value = 'Error'\n      toastMessage.value = 'Failed to clear cache'\n      showToast.value = true\n    }\n  }\n}\n\nasync function logout() {\n  if (confirm('Are you sure you want to logout?')) {\n    await authStore.logout()\n  }\n}\n\nonMounted(() => {\n  // Load saved preferences from localStorage\n  const prefs = localStorage.getItem('driver_app_prefs')\n  if (prefs) {\n    const parsed = JSON.parse(prefs)\n    soundEnabled.value = parsed.soundEnabled ?? true\n    vibrationEnabled.value = parsed.vibrationEnabled ?? true\n    locationEnabled.value = parsed.locationEnabled ?? true\n    highAccuracyMode.value = parsed.highAccuracyMode ?? true\n  }\n})\n\n// Watch and save preferences\nimport { watch } from 'vue'\nwatch(\n  [soundEnabled, vibrationEnabled, locationEnabled, highAccuracyMode],\n  () => {\n    localStorage.setItem('driver_app_prefs', JSON.stringify({\n      soundEnabled: soundEnabled.value,\n      vibrationEnabled: vibrationEnabled.value,\n      locationEnabled: locationEnabled.value,\n      highAccuracyMode: highAccuracyMode.value\n    }))\n  }\n)\n</script>\n"],"file":"Settings-Bi64nMMz.js"}