{"version":3,"file":"Dashboard-G3G3hv0v.js","sources":["../../../../../../frontend/driver-pwa/src/views/Dashboard.vue"],"sourcesContent":["<template>\n  <div class=\"space-y-6\">\n    <!-- Welcome Card -->\n    <div class=\"card p-6 bg-gradient-to-br from-charcoal-600 via-charcoal-500 to-charcoal-600 border-2 border-primary-500/30 shadow-neon\">\n      <div class=\"flex items-center justify-between\">\n        <div>\n          <h2 class=\"text-2xl font-bold mb-1 text-primary-500\">\n            Welcome back, {{ authStore.userName || 'Driver' }}!\n          </h2>\n          <p class=\"text-charcoal-300\">{{ currentDate }}</p>\n        </div>\n        <div class=\"w-16 h-16 bg-primary-500/20 rounded-2xl flex items-center justify-center backdrop-blur-sm border-2 border-primary-500/50\">\n          <User class=\"w-8 h-8 text-primary-500\" />\n        </div>\n      </div>\n      \n      <!-- Quick Stats -->\n      <div class=\"grid grid-cols-3 gap-4 mt-6\">\n        <div class=\"bg-primary-500/10 backdrop-blur-sm rounded-lg p-3 text-center border border-primary-500/30\">\n          <p class=\"text-2xl font-bold text-primary-500\">{{ dashboardData?.journey_plans?.length || 0 }}</p>\n          <p class=\"text-xs text-charcoal-300\">Trips Today</p>\n        </div>\n        <div class=\"bg-primary-500/10 backdrop-blur-sm rounded-lg p-3 text-center border border-primary-500/30\">\n          <p class=\"text-2xl font-bold text-primary-500\">{{ activeTripsCount }}</p>\n          <p class=\"text-xs text-charcoal-300\">Active</p>\n        </div>\n        <div class=\"bg-primary-500/10 backdrop-blur-sm rounded-lg p-3 text-center border border-primary-500/30\">\n          <p class=\"text-2xl font-bold text-primary-500\">{{ dashboardData?.pending_checks?.length || 0 }}</p>\n          <p class=\"text-xs text-charcoal-300\">Pending</p>\n        </div>\n      </div>\n    </div>\n\n    <!-- Driver Qualification Status -->\n    <div \n      v-if=\"dashboardData?.qualification\"\n      class=\"card p-4\"\n      :class=\"qualificationExpiringSoon ? 'border-l-4 border-amber-500' : ''\"\n    >\n      <div class=\"flex items-center justify-between\">\n        <div class=\"flex items-center space-x-3\">\n          <div class=\"w-12 h-12 bg-primary-50 rounded-xl flex items-center justify-center\">\n            <CreditCard class=\"w-6 h-6 text-primary-600\" />\n          </div>\n          <div>\n            <h3 class=\"font-semibold text-gray-900\">Driver License</h3>\n            <p class=\"text-sm text-gray-600\">{{ dashboardData.qualification.license_no }}</p>\n          </div>\n        </div>\n        <div class=\"text-right\">\n          <p class=\"text-xs text-gray-500\">Expires</p>\n          <p \n            class=\"text-sm font-semibold\"\n            :class=\"qualificationExpiringSoon ? 'text-amber-600' : 'text-gray-900'\"\n          >\n            {{ formatDate(dashboardData.qualification.expiry_date) }}\n          </p>\n        </div>\n      </div>\n      <div \n        v-if=\"qualificationExpiringSoon\"\n        class=\"mt-3 p-3 bg-amber-50 rounded-lg flex items-start space-x-2\"\n      >\n        <AlertCircle class=\"w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5\" />\n        <p class=\"text-sm text-amber-700\">\n          Your license is expiring soon. Please renew it to continue driving.\n        </p>\n      </div>\n    </div>\n\n    <!-- Active/Upcoming Trips -->\n    <div class=\"space-y-4\">\n      <div class=\"flex items-center justify-between\">\n        <h3 class=\"section-title mb-0\">Today's Trips</h3>\n        <router-link \n          to=\"/driver/trips\"\n          class=\"text-sm text-primary-600 font-medium flex items-center space-x-1 hover:text-primary-700\"\n        >\n          <span>View All</span>\n          <ChevronRight class=\"w-4 h-4\" />\n        </router-link>\n      </div>\n\n      <LoadingSpinner v-if=\"tripStore.loading\" message=\"Loading trips...\" />\n      \n      <template v-else-if=\"upcomingTrips.length > 0\">\n        <TripCard\n          v-for=\"trip in upcomingTrips\"\n          :key=\"trip.name\"\n          :trip=\"trip\"\n          @start=\"handleStartTrip\"\n          @view=\"handleViewTrip\"\n        />\n      </template>\n      \n      <EmptyState\n        v-else\n        :icon=\"MapPin\"\n        title=\"No trips scheduled\"\n        message=\"You don't have any trips scheduled for today. Check back later or contact dispatch.\"\n      />\n    </div>\n\n    <!-- Pending Actions -->\n    <div \n      v-if=\"hasPendingActions\"\n      class=\"card p-4\"\n    >\n      <h3 class=\"section-title\">Pending Actions</h3>\n      \n      <div class=\"space-y-3\">\n        <!-- Pending Spot Checks -->\n        <div \n          v-if=\"dashboardData?.pending_checks?.length > 0\"\n          class=\"flex items-center justify-between p-3 bg-amber-50 rounded-lg\"\n        >\n          <div class=\"flex items-center space-x-3\">\n            <div class=\"w-10 h-10 bg-amber-100 rounded-lg flex items-center justify-center\">\n              <ClipboardCheck class=\"w-5 h-5 text-amber-600\" />\n            </div>\n            <div>\n              <p class=\"font-medium text-gray-900\">Vehicle Inspection</p>\n              <p class=\"text-sm text-gray-600\">\n                {{ dashboardData.pending_checks.length }} pending check(s)\n              </p>\n            </div>\n          </div>\n          <router-link to=\"/driver/inspection\" class=\"btn-secondary text-sm py-2\">\n            Inspect Now\n          </router-link>\n        </div>\n\n        <!-- Recent Incidents -->\n        <div \n          v-if=\"dashboardData?.recent_incidents?.length > 0\"\n          class=\"flex items-center justify-between p-3 bg-red-50 rounded-lg\"\n        >\n          <div class=\"flex items-center space-x-3\">\n            <div class=\"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center\">\n              <AlertTriangle class=\"w-5 h-5 text-red-600\" />\n            </div>\n            <div>\n              <p class=\"font-medium text-gray-900\">Recent Incidents</p>\n              <p class=\"text-sm text-gray-600\">\n                {{ dashboardData.recent_incidents.length }} incident(s) this week\n              </p>\n            </div>\n          </div>\n          <button class=\"btn-secondary text-sm py-2\" @click=\"showIncidents = true\">\n            View\n          </button>\n        </div>\n      </div>\n    </div>\n\n    <!-- Quick Actions -->\n    <div class=\"grid grid-cols-2 gap-4\">\n      <button\n        @click=\"$router.push('/driver/fuel')\"\n        class=\"card p-4 hover:shadow-lg transition-shadow active:scale-95 duration-200\"\n      >\n        <div class=\"flex flex-col items-center space-y-2 text-center\">\n          <div class=\"w-12 h-12 bg-blue-50 rounded-xl flex items-center justify-center\">\n            <Fuel class=\"w-6 h-6 text-blue-600\" />\n          </div>\n          <p class=\"font-semibold text-gray-900\">Log Fuel</p>\n        </div>\n      </button>\n\n      <button\n        @click=\"$router.push('/driver/incident')\"\n        class=\"card p-4 hover:shadow-lg transition-shadow active:scale-95 duration-200\"\n      >\n        <div class=\"flex flex-col items-center space-y-2 text-center\">\n          <div class=\"w-12 h-12 bg-red-50 rounded-xl flex items-center justify-center\">\n            <AlertTriangle class=\"w-6 h-6 text-red-600\" />\n          </div>\n          <p class=\"font-semibold text-gray-900\">Report Incident</p>\n        </div>\n      </button>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, onMounted } from 'vue'\nimport { useRouter } from 'vue-router'\nimport { format, differenceInDays } from 'date-fns'\nimport { \n  User, MapPin, ChevronRight, CreditCard, \n  AlertCircle, ClipboardCheck, AlertTriangle, Fuel \n} from 'lucide-vue-next'\nimport { useAuth as useAuthStore } from '@shared'\nimport { useTripStore } from '@/stores/trip'\nimport TripCard from '@/components/trip/TripCard.vue'\nimport LoadingSpinner from '@/components/common/LoadingSpinner.vue'\nimport EmptyState from '@/components/common/EmptyState.vue'\n\nconst router = useRouter()\nconst authStore = useAuthStore()\nconst tripStore = useTripStore()\n\nconst dashboardData = ref(null)\nconst showIncidents = ref(false)\n\nconst currentDate = computed(() => format(new Date(), 'EEEE, MMMM d, yyyy'))\n\nconst upcomingTrips = computed(() => {\n  if (!dashboardData.value) return []\n  \n  const journeys = dashboardData.value.journey_plans || []\n  const operations = dashboardData.value.operation_plans || []\n  \n  return [...journeys, ...operations]\n    .sort((a, b) => new Date(a.start_time) - new Date(b.start_time))\n    .slice(0, 3)\n})\n\nconst activeTripsCount = computed(() => {\n  if (!dashboardData.value) return 0\n  const operations = dashboardData.value.operation_plans || []\n  return operations.filter(op => op.status === 'Active').length\n})\n\nconst qualificationExpiringSoon = computed(() => {\n  if (!dashboardData.value?.qualification?.expiry_date) return false\n  const daysUntilExpiry = differenceInDays(\n    new Date(dashboardData.value.qualification.expiry_date),\n    new Date()\n  )\n  return daysUntilExpiry <= 30 && daysUntilExpiry >= 0\n})\n\nconst hasPendingActions = computed(() => {\n  return (dashboardData.value?.pending_checks?.length > 0) || \n         (dashboardData.value?.recent_incidents?.length > 0)\n})\n\nfunction formatDate(date) {\n  return format(new Date(date), 'MMM d, yyyy')\n}\n\nasync function handleStartTrip(trip) {\n  router.push(`/driver/trips/${trip.name}?action=start`)\n}\n\nfunction handleViewTrip(trip) {\n  router.push(`/driver/trips/${trip.name}`)\n}\n\nonMounted(async () => {\n  try {\n    // Ensure auth is loaded first\n    if (!authStore.isAuthenticated) {\n      await authStore.fetchUserInfo()\n    }\n    dashboardData.value = await tripStore.fetchDashboard()\n  } catch (error) {\n    console.error('Failed to load dashboard:', error)\n  }\n})\n</script>"],"names":["router","useRouter","authStore","useAuthStore","tripStore","useTripStore","dashboardData","ref","showIncidents","currentDate","computed","format","upcomingTrips","journeys","operations","a","b","activeTripsCount","op","qualificationExpiringSoon","daysUntilExpiry","differenceInDays","hasPendingActions","formatDate","date","handleStartTrip","trip","handleViewTrip","onMounted","error","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_hoisted_4","_unref","_hoisted_5","_toDisplayString","_hoisted_6","_createVNode","User","_hoisted_7","_hoisted_8","_hoisted_9","_cache","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_normalizeClass","_hoisted_14","_hoisted_15","_hoisted_16","CreditCard","_hoisted_17","_hoisted_18","_hoisted_19","AlertCircle","_hoisted_20","_hoisted_21","_component_router_link","ChevronRight","_createBlock","LoadingSpinner","_Fragment","_renderList","TripCard","EmptyState","MapPin","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","ClipboardCheck","_hoisted_27","_hoisted_28","_hoisted_29","_hoisted_30","AlertTriangle","_hoisted_31","_hoisted_32","$event","$router","_hoisted_33","_hoisted_34","Fuel","_hoisted_35","_hoisted_36"],"mappings":"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"}